/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/checkout6-custom.js":
/*!*********************************!*\
  !*** ./src/checkout6-custom.js ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _controller_CollectController__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./controller/CollectController */ \"./src/controller/CollectController.js\");\n/* harmony import */ var _controller_DeliverController__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./controller/DeliverController */ \"./src/controller/DeliverController.js\");\n/* harmony import */ var _controller_FormController__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./controller/FormController */ \"./src/controller/FormController.js\");\n/* harmony import */ var _controller_ViewController__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./controller/ViewController */ \"./src/controller/ViewController.js\");\n// // import AddressController from './controller/AddressController';\nvar script = document.createElement('script');\nscript.setAttribute('src', 'https://unpkg.com/penpal@^6/dist/penpal.min.js');\ndocument.head.appendChild(script);\n\n\n\n // // AddressController.init();\n\n_controller_ViewController__WEBPACK_IMPORTED_MODULE_3__[\"default\"].init();\n_controller_FormController__WEBPACK_IMPORTED_MODULE_2__[\"default\"].init();\n_controller_CollectController__WEBPACK_IMPORTED_MODULE_0__[\"default\"].init();\n_controller_DeliverController__WEBPACK_IMPORTED_MODULE_1__[\"default\"].init();\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/checkout6-custom.js?");

/***/ }),

/***/ "./src/controller/CollectController.js":
/*!*********************************************!*\
  !*** ./src/controller/CollectController.js ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _partials__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../partials */ \"./src/partials/index.js\");\n/* harmony import */ var _partials_Deliver_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../partials/Deliver/utils */ \"./src/partials/Deliver/utils.js\");\n/* harmony import */ var _utils_const__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/const */ \"./src/utils/const.js\");\n/* harmony import */ var _utils_functions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/functions */ \"./src/utils/functions.js\");\n\n\n\n\n\nconst CollectController = (() => {\n  const state = {\n    inCollect: false,\n    pickupSelected: false,\n    validForm: false,\n    runningObserver: false,\n    collectReset: false\n  };\n\n  const changeTranslations = () => {\n    $('p.vtex-omnishipping-1-x-shippingSectionTitle').text('Collect options');\n    $('#change-pickup-button').text('Available pickup points');\n    $('h2.vtex-omnishipping-1-x-geolocationTitle.ask-for-geolocation-title').text('Find nearby Click & Collect points');\n    $('h3.vtex-omnishipping-1-x-subtitle.ask-for-geolocation-subtitle').text(\"Search for addresses that you frequently use and we'll locate stores nearby.\");\n\n    if (state.pickupSelected) {\n      $('label.shp-pickup-receiver__label').text(\"Recipient's name\");\n    }\n  };\n\n  const resetPickup = () => {\n    $('.delivery-group-content').empty();\n    $('.btn-go-to-payment-wrapper').empty();\n    $('<div><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path d=\"M12,1A11,11,0,1,0,23,12,11,11,0,0,0,12,1Zm0,19a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z\" opacity=\".25\" stroke=\"#FCFCFC\" fill=\"#FCFCFC\"/><path d=\"M12,4a8,8,0,0,1,7.89,6.7A1.53,1.53,0,0,0,21.38,12h0a1.5,1.5,0,0,0,1.48-1.75,11,11,0,0,0-21.72,0A1.5,1.5,0,0,0,2.62,12h0a1.53,1.53,0,0,0,1.49-1.3A8,8,0,0,1,12,4Z\" stroke=\"#000\" fill=\"#000\"><animateTransform attributeName=\"transform\" type=\"rotate\" dur=\"0.75s\" values=\"0 12 12;360 12 12\" repeatCount=\"indefinite\"/></path></svg><div>').css({\n      'display': 'flex',\n      'justify-content': 'center',\n      'align-items': 'center',\n      'min-height': '100px'\n    }).appendTo('.delivery-group-content');\n    const orderForm = window.vtexjs.checkout.orderForm;\n    const {\n      shippingData\n    } = orderForm;\n    const retShipping = { ...shippingData,\n      address: null,\n      availableAddresses: shippingData.availableAddresses,\n      selectedAddresses: shippingData.selectedAddresses.filter(add => add.addressType !== 'search'),\n      logisticsInfo: shippingData.logisticsInfo\n    };\n    window.vtexjs.checkout.sendAttachment('shippingData', retShipping);\n    (0,_partials_Deliver_utils__WEBPACK_IMPORTED_MODULE_1__.setPickupLoading)();\n  };\n\n  const pickupMap = () => {\n    // Pickup Point Map\n    $('.pickup-marker-blue').remove();\n\n    if ($('#change-pickup-button').length) {\n      $('<button class=\"vtex-omnishipping-1-x-pickupPointSeeMore button-see-pickup-point btn btn-link\" id=\"tfg-pickup-see-more-button\" type=\"button\">Collect Point Details</button>').appendTo('.vtex-omnishipping-1-x-PickupPoint');\n      $('<button class=\"vtex-change-pickup button-change-pickup-point\" id=\"tfg-pickup-button\" type=\"button\">Change</button>').appendTo('.vtex-omnishipping-1-x-PickupPoint');\n      $('#change-pickup-button').remove();\n      $('#details-pickup-button').remove();\n    }\n\n    if ($('.vtex-omnishipping-1-x-ask').length) {\n      $('.vtex-omnishipping-1-x-ask').empty();\n      $(`<div class=\"pickup-map-container\">\n          <div class=\"pickup-map-icon\">\n            <svg class=\"icon-map\" xmlns=\"http://www.w3.org/2000/svg\" width=\"48\" height=\"48\" viewBox=\"0 0 48 48\" fill=\"none\">\n              <rect width=\"48\" height=\"48\" rx=\"24\" fill=\"#2424E4\"/>\n              <path d=\"M24.2147 11C21.5065 11.0031 18.9102 12.0802 16.9952 13.9952C15.0802 15.9102 14.0031 18.5065 14 21.2147C14 29.9552 23.2861 36.5599 23.6807 36.8385C23.8389 36.9438 24.0247 37 24.2147 37C24.4047 37 24.5905 36.9438 24.7486 36.8385C25.1433 36.5599 34.4294 29.9552 34.4294 21.2147C34.4263 18.5065 33.3491 15.9102 31.4342 13.9952C29.5192 12.0802 26.9228 11.0031 24.2147 11ZM24.2147 17.5003C24.9493 17.5003 25.6675 17.7181 26.2783 18.1262C26.8891 18.5344 27.3652 19.1145 27.6464 19.7932C27.9275 20.472 28.0011 21.2188 27.8577 21.9393C27.7144 22.6599 27.3607 23.3217 26.8412 23.8412C26.3217 24.3607 25.6599 24.7144 24.9393 24.8577C24.2188 25.0011 23.472 24.9275 22.7932 24.6464C22.1145 24.3652 21.5344 23.8891 21.1262 23.2783C20.7181 22.6675 20.5003 21.9493 20.5003 21.2147C20.5003 20.2296 20.8916 19.2848 21.5882 18.5882C22.2848 17.8916 23.2296 17.5003 24.2147 17.5003Z\" fill=\"#FCFCFC\"/>\n            </svg>\n            Find nearby collect points\n            <div class=\"pickup-map-text\">\n              Search for addresses that you frequently use and we’ll locate stores nearby.\n            </div>\n          </div>\n          <button class=\"pickup-map-geolocation\" id=\"find-pickups-button-new\" type=\"button\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"16\" viewBox=\"0 0 15 16\" fill=\"none\">\n              <path d=\"M1.12954 2.34666L5.24985 14.2506C5.42563 14.7639 6.15688 14.7498 6.3186 14.2295L7.97798 8.84354C8.00302 8.75549 8.05054 8.67548 8.11588 8.61138C8.18122 8.54727 8.26213 8.50127 8.35063 8.47791L13.7295 6.81854C14.2499 6.65682 14.2639 5.92557 13.7506 5.74979L1.84672 1.62948C1.74671 1.59433 1.6388 1.58815 1.53542 1.61167C1.43205 1.63519 1.33743 1.68745 1.26247 1.76241C1.18751 1.83737 1.13525 1.93199 1.11173 2.03536C1.08822 2.13873 1.09439 2.24665 1.12954 2.34666V2.34666Z\" stroke=\"#2424E4\" stroke-width=\"1.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n            </svg>\n            Use my current location\n          </button>\n          <button class=\"pickup-map-manual\" id=\"find-pickups-manually-search\">\n            Manually search for an address\n          </button>\n        </div>`).appendTo('.vtex-omnishipping-1-x-ask');\n    }\n\n    $('#pkpmodal-close').unbind().click(function () {\n      $('#tfg-pickup-map').remove();\n    });\n\n    const iframeFunctions = function (state) {\n      $('<div class=\"tfg-pickup-map\" id=\"tfg-pickup-map\"><div class=\"tfg-pickup-map-content\"></div></div>').appendTo($('body'));\n      $('body').css('position', 'fixed');\n      $('body').css('width', '100%');\n      const iframe = document.createElement('iframe');\n      iframe.src = 'https://pickup-map-staging.bashconnect.com/';\n      iframe.width = '100%';\n      iframe.height = '100%';\n      iframe.id = 'map';\n      iframe.allow = \"geolocation\";\n      $(iframe).appendTo('.tfg-pickup-map-content');\n      const connection = window.Penpal.connectToChild({\n        iframe,\n        methods: {\n          sendAttachment: data => {\n            (0,_partials_Deliver_utils__WEBPACK_IMPORTED_MODULE_1__.setPickupLoading)();\n            window.vtexjs.checkout.sendAttachment('shippingData', data);\n            $('#tfg-pickup-map').remove();\n            $('body').css('overflow', 'auto');\n            $('body').css('width', 'auto');\n            $('body').css('position', 'relative');\n          },\n          getCheckoutJS: () => {\n            return window.vtexjs.checkout.orderForm;\n          },\n          getSpecialFields: () => {\n            return (0,_utils_functions__WEBPACK_IMPORTED_MODULE_3__.getSpecialCategories)(window.vtexjs.checkout.orderForm.items);\n          },\n          remove: () => {\n            $('#tfg-pickup-map').remove();\n            $('body').css('overflow', 'auto');\n            $('body').css('width', 'auto');\n            $('body').css('position', 'relative');\n          },\n          getState: () => {\n            return state;\n          }\n        }\n      });\n      $('#tfg-pickup-map').click(function (e) {\n        e.stopPropagation();\n        $('#tfg-pickup-map').remove();\n        $('body').css('overflow', 'auto');\n        $('body').css('width', 'auto');\n        $('body').css('position', 'relative');\n      });\n    };\n\n    $(\"#tfg-pickup-button\").unbind().click(() => iframeFunctions(_utils_const__WEBPACK_IMPORTED_MODULE_2__.NONE));\n    $(\"#tfg-pickup-see-more-button\").unbind().click(() => iframeFunctions(_utils_const__WEBPACK_IMPORTED_MODULE_2__.PICKUP));\n    $('#find-pickups-button-new').unbind().click(() => iframeFunctions(_utils_const__WEBPACK_IMPORTED_MODULE_2__.GEOLOCATE));\n    $('#find-pickups-manually-search').unbind().click(() => iframeFunctions(_utils_const__WEBPACK_IMPORTED_MODULE_2__.MANUAL));\n  };\n\n  const checkFields = fields => {\n    fields.forEach(field => {\n      let isValid = true;\n      let parent;\n\n      switch (field) {\n        case 'pickup-receiver':\n          isValid = !($(`#${field}`).length > 0 && !$(`#${field}`).attr('disabled') && !$(`#${field}`).val());\n          parent = '.shp-pickup-receiver';\n          break;\n\n        case 'custom-pickup-complement':\n          isValid = (0,_utils_functions__WEBPACK_IMPORTED_MODULE_3__.isValidNumberBash)($(`#${field}`).val());\n          parent = '#box-pickup-complement';\n          break;\n\n        default:\n          break;\n      }\n\n      if (!isValid) {\n        $(parent).addClass('error');\n        $(parent).append((0,_partials__WEBPACK_IMPORTED_MODULE_0__.InputError)());\n        $(`${parent} span.error`).show();\n        state.validForm = false;\n      } else {\n        $(parent).removeClass('error');\n      }\n    });\n  };\n\n  const checkForm = () => {\n    $('span.help.error').remove();\n    state.validForm = true;\n    checkFields(['pickup-receiver', 'custom-pickup-complement']);\n  };\n\n  const saveCollectFields = () => {\n    checkForm();\n\n    if (state.validForm) {\n      let collectPhone = $('#custom-pickup-complement').val().replace(/\\s/g, '');\n\n      if (collectPhone.length === 9 && collectPhone[0] !== '0') {\n        collectPhone = `0${collectPhone}`;\n      }\n\n      localStorage.setItem('saving-shipping-collect', true);\n      $('#btn-go-to-payment').trigger('click');\n      setTimeout(() => {\n        window.vtexjs.checkout.getOrderForm().then(orderForm => {\n          const {\n            address\n          } = orderForm.shippingData;\n          address.complement = collectPhone;\n          return window.vtexjs.checkout.calculateShipping(address);\n        }).done(() => {\n          localStorage.removeItem('saving-shipping-collect');\n        });\n      }, _utils_const__WEBPACK_IMPORTED_MODULE_2__.TIMEOUT_750);\n    }\n  }; //! TODO: al merger a develop podemos refactorizar esta función llevándola a utils\n\n\n  const setInputPhone = () => {\n    const phoneInput = document.querySelector('input#custom-pickup-complement');\n\n    if (phoneInput) {\n      phoneInput.setAttribute('placeholder', '');\n    }\n  };\n\n  const prePopulateReceiverName = () => {\n    const {\n      firstName,\n      lastName\n    } = window.vtexjs.checkout.orderForm?.clientProfileData;\n    const firstNameInput = $('#client-first-name').val();\n    const lastNameInput = $('#client-last-name').val();\n    const receiverName = firstName ? [firstName, lastName].join(' ') : [firstNameInput, lastNameInput].join(' ');\n\n    if ($('input#pickup-receiver').val() === '') {\n      $('input#pickup-receiver').val(receiverName.trim());\n      window.vtexjs.checkout.getOrderForm().then(orderForm => {\n        const {\n          shippingData\n        } = orderForm;\n        shippingData.address.receiverName = receiverName.trim();\n        return window.vtexjs.checkout.sendAttachment('shippingData', shippingData);\n      });\n    }\n  };\n\n  const addCustomPhoneInput = () => {\n    /* Set orderForm value if exists */\n    const phoneNumber = window.vtexjs.checkout.orderForm?.clientProfileData?.phone ?? $('#client-phone').val() ?? '';\n\n    if ($('input#custom-pickup-complement').length === 0) {\n      $('.btn-go-to-payment-wrapper').before(_partials__WEBPACK_IMPORTED_MODULE_0__.PickupComplementField);\n      setInputPhone();\n\n      if (phoneNumber) {\n        $('input#custom-pickup-complement').val(phoneNumber);\n      }\n    } else if ($('input#custom-pickup-complement').val() === '') {\n      $('input#custom-pickup-complement').val(phoneNumber);\n      window.vtexjs.checkout.getOrderForm().then(orderForm => {\n        const {\n          shippingData\n        } = orderForm;\n        shippingData.address.complement = phoneNumber;\n        return window.vtexjs.checkout.sendAttachment('shippingData', shippingData);\n      });\n    }\n\n    prePopulateReceiverName();\n  }; //! TODO: al merger a develop podemos refactorizar esta función llevándola a utils\n\n\n  const addCustomBtnPayment = () => {\n    if ($('#custom-go-to-payment').length <= 0) {\n      const nativePaymentBtn = $('#btn-go-to-payment');\n      const customPaymentBtn = nativePaymentBtn.clone(false);\n      $(nativePaymentBtn).hide();\n      $(customPaymentBtn).data('bind', '');\n      $(customPaymentBtn).removeAttr('id').attr('id', 'custom-go-to-payment');\n      $(customPaymentBtn).removeAttr('data-bind');\n      $(customPaymentBtn).css('display', 'block');\n      $('p.btn-go-to-payment-wrapper').append(customPaymentBtn);\n      $(customPaymentBtn).on('click', saveCollectFields);\n    }\n  };\n\n  const runCustomization = () => {\n    const shippingLoaded = $('div#postalCode-finished-loading').length > 0;\n    $('#shipping-option-pickup-in-point').one('click', function () {\n      state.collectReset = true;\n    });\n\n    if (window.location.hash === _utils_const__WEBPACK_IMPORTED_MODULE_2__.STEPS.SHIPPING && shippingLoaded) {\n      state.inCollect = $('#shipping-option-pickup-in-point').hasClass('shp-method-option-active');\n      state.pickupSelected = $('div.ask-for-geolocation').length === 0;\n\n      if (state.inCollect) {\n        (0,_utils_functions__WEBPACK_IMPORTED_MODULE_3__.clearLoaders)();\n        pickupMap();\n\n        if (state.pickupSelected && !state.collectReset) {\n          $('button.shp-pickup-receiver__btn').trigger('click');\n          $('div.shp-pickup-receiver').addClass('show');\n          $('p#box-pickup-complement').addClass('show');\n          addCustomPhoneInput();\n          addCustomBtnPayment();\n        } else {\n          $('div.shp-pickup-receiver').removeClass('show');\n          $('p#box-pickup-complement').removeClass('show');\n        }\n\n        if (state.collectReset) {\n          resetPickup();\n          state.collectReset = false;\n        }\n\n        changeTranslations();\n      }\n      /* If it has been redirected because of missing values, the click is forced to show the errors */\n\n\n      if (localStorage.getItem('shipping-incomplete-values')) {\n        $('#custom-go-to-payment').trigger('click');\n        localStorage.removeItem('shipping-incomplete-values');\n      }\n    } else {\n      /* Remove box-pickup-complement so that the input does not appear in the other steps of the checkout process  */\n      $('#box-pickup-complement').remove();\n\n      if (window.location.hash === _utils_const__WEBPACK_IMPORTED_MODULE_2__.STEPS.PAYMENT) {\n        setTimeout(() => {\n          const address = window.vtexjs.checkout.orderForm?.shippingData?.address;\n          const savingCollect = localStorage.getItem('saving-shipping-collect');\n\n          if (!savingCollect) {\n            /* Redirect to shipping if required fields are empty */\n            if (address && address.addressType === _utils_const__WEBPACK_IMPORTED_MODULE_2__.AD_TYPE.PICKUP && (!address.receiverName || !address.complement)) {\n              window.location.hash = _utils_const__WEBPACK_IMPORTED_MODULE_2__.STEPS.SHIPPING;\n              localStorage.setItem('shipping-incomplete-values', true);\n            }\n          }\n        }, 1000);\n      }\n    } // eslint-disable-next-line no-use-before-define\n\n\n    runCollectObserver();\n  };\n  /* We need this observer to detect the change in the deliver and collect buttons */\n\n\n  const runCollectObserver = () => {\n    if (state.runningObserver) return;\n    const elementToObserveChange = document.querySelector('.shipping-container .box-step');\n    const observerConfig = {\n      attributes: false,\n      childList: true,\n      characterData: false\n    };\n    const observer = new MutationObserver(() => {\n      state.runningObserver = true;\n      runCustomization();\n    });\n\n    if (elementToObserveChange) {\n      observer.observe(elementToObserveChange, observerConfig);\n    }\n  }; // EVENTS SUBSCRIPTION\n\n\n  $(document).ready(() => {\n    runCustomization();\n  });\n  $(window).on('hashchange orderFormUpdated.vtex', () => {\n    runCustomization();\n  });\n  return {\n    state,\n    init: () => {}\n  };\n})();\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (CollectController);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/controller/CollectController.js?");

/***/ }),

/***/ "./src/controller/DeliverController.js":
/*!*********************************************!*\
  !*** ./src/controller/DeliverController.js ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _partials_Deliver_DeliverContainer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../partials/Deliver/DeliverContainer */ \"./src/partials/Deliver/DeliverContainer.js\");\n/* harmony import */ var _partials_Deliver_ExtraFieldsContainer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../partials/Deliver/ExtraFieldsContainer */ \"./src/partials/Deliver/ExtraFieldsContainer.js\");\n/* harmony import */ var _partials_Deliver_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../partials/Deliver/utils */ \"./src/partials/Deliver/utils.js\");\n/* harmony import */ var _utils_const__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/const */ \"./src/utils/const.js\");\n/* harmony import */ var _utils_functions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/functions */ \"./src/utils/functions.js\");\n/* harmony import */ var _utils_services__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/services */ \"./src/utils/services.js\");\n\n\n\n\n\n\n\nconst DeliverController = (() => {\n  const state = {\n    view: 'list',\n    hasFurn: false,\n    hasTVs: false,\n    hasSim: false\n  };\n\n  const setupDeliver = () => {\n    if ($('#bash--delivery-container').length) return;\n\n    if (window.vtexjs.checkout.orderForm) {\n      const items = window.vtexjs.checkout.orderForm?.items;\n      const {\n        hasFurniture,\n        hasTVs,\n        hasSimCards\n      } = (0,_utils_functions__WEBPACK_IMPORTED_MODULE_4__.getSpecialCategories)(items);\n      state.hasFurn = hasFurniture;\n      state.hasTVs = hasTVs;\n      state.hasSim = hasSimCards;\n    }\n\n    $('.shipping-data .box-step').append((0,_partials_Deliver_DeliverContainer__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n      hasFurn: state.hasFurn\n    }));\n    const showExtraFields = state.hasFurn || state.hasSim || state.hasTVs;\n\n    if (showExtraFields) {\n      $('#bash-delivery-options').before((0,_partials_Deliver_ExtraFieldsContainer__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n        hasFurn: state.hasFurn,\n        hasSim: state.hasSim,\n        hasTV: state.hasTVs\n      }));\n      if (state.hasSim) (0,_partials_Deliver_utils__WEBPACK_IMPORTED_MODULE_2__.populateRicaFields)();\n      if (state.hasTVs) (0,_partials_Deliver_utils__WEBPACK_IMPORTED_MODULE_2__.populateTVFields)();\n    }\n\n    const fieldsToValidate = 'select, input'; // eslint-disable-next-line func-names\n\n    $(fieldsToValidate).on('invalid', function () {\n      const field = this;\n      $(field)[0].setCustomValidity(' ');\n      $(field).parents('form').addClass('show-form-errors');\n      $(field).off('change keyUp');\n      $(field).on('change keyUp', () => {\n        $(field)[0].setCustomValidity('');\n      });\n    });\n  }; // EVENTS\n\n\n  $(window).unload(() => {\n    (0,_utils_services__WEBPACK_IMPORTED_MODULE_5__.clearAddresses)();\n  });\n  $(document).ready(() => {\n    (0,_utils_services__WEBPACK_IMPORTED_MODULE_5__.clearAddresses)();\n\n    if (window.location.hash === _utils_const__WEBPACK_IMPORTED_MODULE_3__.STEPS.SHIPPING) {\n      setupDeliver();\n      $('.bash--delivery-container.hide').removeClass('hide');\n      $('.bash--delivery-container').css('display', 'flex');\n    } else if ($('.bash--delivery-container:not(.hide)').length) {\n      $('.bash--delivery-container:not(.hide)').addClasså('hide');\n      $('.bash--delivery-container').css('display', 'none');\n    }\n  });\n  $(window).on('hashchange', () => {\n    if (window.location.hash === _utils_const__WEBPACK_IMPORTED_MODULE_3__.STEPS.SHIPPING) {\n      setupDeliver();\n      (0,_partials_Deliver_utils__WEBPACK_IMPORTED_MODULE_2__.setCartClasses)();\n      $('.bash--delivery-container').css('display', 'flex');\n      $('.bash--delivery-container.hide').removeClass('hide');\n    } else if ($('.bash--delivery-container:not(.hide)').length) {\n      $('.bash--delivery-container:not(.hide)').addClass('hide');\n      $('.bash--delivery-container').css('display', 'none');\n    }\n  }); // Define which tab is active ;/\n\n  $(window).on('orderFormUpdated.vtex', () => {\n    const items = window.vtexjs.checkout.orderForm?.items;\n    const addressType = window.vtexjs.checkout.orderForm.shippingData?.address?.addressType;\n    const {\n      hasTVs,\n      hasSimCards\n    } = (0,_utils_functions__WEBPACK_IMPORTED_MODULE_4__.getSpecialCategories)(items);\n    const {\n      messages\n    } = window.vtexjs.checkout.orderForm;\n\n    if (window.location.hash === _utils_const__WEBPACK_IMPORTED_MODULE_3__.STEPS.SHIPPING) {\n      const errors = messages.filter(msg => msg.status === 'error');\n      if (errors) (0,_partials_Deliver_utils__WEBPACK_IMPORTED_MODULE_2__.populateDeliveryError)(errors);\n    }\n\n    if (addressType === 'search') {\n      // User has Collect enabled, but has Rica or TV products.\n      if (hasTVs || hasSimCards) {\n        if (window.location.hash !== _utils_const__WEBPACK_IMPORTED_MODULE_3__.STEPS.SHIPPING) window.location.hash = _utils_const__WEBPACK_IMPORTED_MODULE_3__.STEPS.SHIPPING;\n        setTimeout(() => document.getElementById('shipping-option-delivery')?.click(), 2000);\n        return;\n      }\n\n      $('#shipping-data:not(collection-active)').addClass('collection-active');\n      $('.delivery-active').removeClass('delivery-active');\n    } else {\n      setupDeliver();\n      $('#shipping-data:not(delivery-active)').addClass('delivery-active');\n      $('.collection-active').removeClass('collection-active');\n    }\n\n    (0,_partials_Deliver_utils__WEBPACK_IMPORTED_MODULE_2__.setCartClasses)();\n    (0,_partials_Deliver_utils__WEBPACK_IMPORTED_MODULE_2__.updateDeliveryFeeDisplay)();\n\n    if (window.location.hash === _utils_const__WEBPACK_IMPORTED_MODULE_3__.STEPS.PAYMENT && !(0,_partials_Deliver_utils__WEBPACK_IMPORTED_MODULE_2__.customShippingDataIsValid)()) {\n      window.location.hash = _utils_const__WEBPACK_IMPORTED_MODULE_3__.STEPS.SHIPPING;\n    }\n  }); // Change view\n\n  $(document).on('click', 'a[data-view]', function (e) {\n    e.preventDefault();\n    const viewTarget = $(this).data('view');\n    const content = decodeURIComponent($(this).data('content'));\n    window.postMessage({\n      action: 'setDeliveryView',\n      view: viewTarget,\n      content\n    });\n  }); // Select address\n\n  $(document).on('change', 'input[type=\"radio\"][name=\"selected-address\"]', function () {\n    const address = (0,_partials_Deliver_utils__WEBPACK_IMPORTED_MODULE_2__.parseAttribute)($(this).parents('.bash--address-listing').data('address'));\n\n    if (document.forms['bash--delivery-form']) {\n      document.forms['bash--delivery-form'].reset();\n      document.forms['bash--delivery-form'].classList.remove('show-form-errors');\n    }\n\n    (0,_utils_services__WEBPACK_IMPORTED_MODULE_5__.getAddressByName)(address.addressName).then(addressByName => {\n      (0,_partials_Deliver_utils__WEBPACK_IMPORTED_MODULE_2__.setAddress)(addressByName || address, {\n        validateExtraFields: false\n      });\n      $('input[type=\"radio\"][name=\"selected-address\"]:checked').attr('checked', false);\n      $(this).attr('checked', true);\n    });\n  }); // Rica - show/hide address fields\n\n  $(document).on('change', '#bash--input-rica_sameAddress', function () {\n    if (this.checked) {\n      $('.rica-conditional-fields').slideUp(() => (0,_partials_Deliver_utils__WEBPACK_IMPORTED_MODULE_2__.populateRicaFields)());\n    } else {\n      (0,_partials_Deliver_utils__WEBPACK_IMPORTED_MODULE_2__.clearRicaFields)();\n      $('.rica-conditional-fields').slideDown(() => $('#bash--input-rica_fullName').focus());\n    }\n  }); // address type - change building/complex label to either business\n\n  $(document).on('change', 'input[name=\"addressType\"]', function () {\n    if ($(this).is(':checked')) {\n      if ($(this).val() === 'business') {\n        $('#bash--label-companyBuilding').text('Business name');\n      } else {\n        $('#bash--label-companyBuilding').text('Building/Complex and number');\n      }\n    }\n  }); // switching to between shipping options\n  // hide delivery container when switching to collect\n\n  $(document).on('click', '#shipping-option-pickup-in-point, #shipping-option-delivery', function () {\n    const clickedButton = $(this).attr('id');\n\n    if (clickedButton === 'shipping-option-pickup-in-point') {\n      $('#bash--delivery-container').hide();\n    } else {\n      $('#bash--delivery-container').show();\n    }\n  });\n  $(document).on('submit', '#bash--address-form', _partials_Deliver_utils__WEBPACK_IMPORTED_MODULE_2__.submitAddressForm);\n  $(document).on('submit', '#bash--delivery-form', _partials_Deliver_utils__WEBPACK_IMPORTED_MODULE_2__.submitDeliveryForm);\n  $(document).on('click', '.remove-cart-item', function (e) {\n    e.preventDefault();\n    (0,_utils_services__WEBPACK_IMPORTED_MODULE_5__.removeFromCart)($(this).data('index'));\n  }); // Form validation\n\n  window.addEventListener('message', event => {\n    const {\n      data\n    } = event;\n    if (!data || !data.action) return;\n\n    switch (data.action) {\n      case 'setDeliveryView':\n        document.querySelector('.bash--delivery-container').setAttribute('data-view', data.view);\n\n        if (data.view === 'address-form' || data.view === 'address-edit') {\n          (0,_partials_Deliver_utils__WEBPACK_IMPORTED_MODULE_2__.preparePhoneField)('#bash--input-complement');\n\n          if (data.content) {\n            const address = JSON.parse(decodeURIComponent($(`#${data.content}`).data('address')));\n            (0,_partials_Deliver_utils__WEBPACK_IMPORTED_MODULE_2__.populateAddressForm)(address);\n          }\n        }\n\n        break;\n\n      default:\n        console.error('Unknown action', data.action);\n    }\n  }); // Clear local checkout DB on ext.\n  // window.addEventListener('beforeunload', clearAddresses);\n\n  return {\n    state,\n    init: () => {}\n  };\n})();\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (DeliverController);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/controller/DeliverController.js?");

/***/ }),

/***/ "./src/controller/FormController.js":
/*!******************************************!*\
  !*** ./src/controller/FormController.js ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _partials__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../partials */ \"./src/partials/index.js\");\n/* harmony import */ var _utils_const__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/const */ \"./src/utils/const.js\");\n/* harmony import */ var _utils_functions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/functions */ \"./src/utils/functions.js\");\n/* harmony import */ var _ViewController__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ViewController */ \"./src/controller/ViewController.js\");\n/* eslint-disable func-names */\n\n\n\n\n\nconst FormController = (() => {\n  const state = {\n    validForm: true,\n    runningObserver: false\n  };\n\n  const checkField = field => {\n    if ($(`#${field}`).length > 0 && !$(`#${field}`).attr('disabled') && !$(`#${field}`).val()) {\n      $(`.${field}`).addClass('error');\n      $(`.${field}`).append(_partials__WEBPACK_IMPORTED_MODULE_0__.InputError);\n      $(`.${field} span.error`).show();\n      state.validForm = false;\n    } else {\n      $(`.${field}`).removeClass('error');\n    }\n  };\n\n  const checkFields = fields => {\n    fields.forEach(field => {\n      checkField(field);\n    });\n  };\n\n  const checkRICAForm = () => {\n    const ricaFields = ['tfg-rica-id-passport', 'tfg-rica-fullname', 'tfg-rica-street', 'tfg-rica-suburb', 'tfg-rica-city', 'tfg-rica-postal-code', 'tfg-rica-province'];\n    checkFields(ricaFields);\n  };\n\n  const checkForm = () => {\n    // Reset state & clear errors\n    $('span.help.error').remove();\n    state.validForm = true;\n    /* Checking Receiver & Receiver Phone */\n\n    if ($('div.address-list.vtex-omnishipping-1-x-addressList').length <= 0) {\n      checkField('ship-receiverName');\n\n      if (!(0,_utils_functions__WEBPACK_IMPORTED_MODULE_2__.isValidNumberBash)(document.querySelector('.vtex-omnishipping-1-x-address input#ship-complement').value)) {\n        $('.vtex-omnishipping-1-x-address .ship-complement').addClass('error');\n        $('.vtex-omnishipping-1-x-address .ship-complement').append((0,_partials__WEBPACK_IMPORTED_MODULE_0__.InputError)());\n        $('.vtex-omnishipping-1-x-address .ship-complement span.error').show();\n        state.validForm = false;\n      } else {\n        $('.vtex-omnishipping-1-x-address .ship-complement').removeClass('error');\n      }\n    }\n    /* Checking Custom Fields */\n\n\n    if (_ViewController__WEBPACK_IMPORTED_MODULE_3__[\"default\"].state.showRICAForm) {\n      checkRICAForm();\n    }\n\n    if (_ViewController__WEBPACK_IMPORTED_MODULE_3__[\"default\"].state.showTVIDForm) {\n      checkField('tfg-tv-licence');\n    }\n  };\n\n  const getRICAFields = () => {\n    const ricaFields = {};\n    ricaFields.idOrPassport = $('#tfg-rica-id-passport').val();\n    ricaFields.sameAddress = $('#tfg-rica-same-address').is(':checked');\n    ricaFields.fullName = $('#tfg-rica-fullname').val();\n    ricaFields.streetAddress = $('#tfg-rica-street').val();\n    ricaFields.suburb = $('#tfg-rica-suburb').val();\n    ricaFields.city = $('#tfg-rica-city').val();\n    ricaFields.postalCode = $('#tfg-rica-postal-code').val();\n    ricaFields.province = $('#tfg-rica-province').val();\n    ricaFields.country = $('#tfg-rica-country').val();\n    return ricaFields;\n  };\n\n  const saveAddressType = () => {\n    const addressType = localStorage.getItem('addressType');\n    window.vtexjs.checkout.getOrderForm().then(orderForm => {\n      const {\n        shippingData\n      } = orderForm;\n      shippingData.selectedAddresses[0].addressType = addressType;\n      return window.vtexjs.checkout.sendAttachment('shippingData', shippingData);\n    });\n  };\n\n  const getTVFormFields = () => ({\n    tvID: $('#tfg-tv-licence').val()\n  });\n\n  const saveShippingForm = () => {\n    const {\n      showRICAForm,\n      showTVIDForm\n    } = _ViewController__WEBPACK_IMPORTED_MODULE_3__[\"default\"].state;\n    checkForm();\n\n    if (state.validForm) {\n      // Fields saved in orderForm\n      if (showRICAForm) {\n        const ricaFields = getRICAFields();\n        (0,_utils_functions__WEBPACK_IMPORTED_MODULE_2__.checkoutSendCustomData)(_utils_const__WEBPACK_IMPORTED_MODULE_1__.RICA_APP, ricaFields);\n      } // Fields saved in Masterdata\n\n\n      const masterdataFields = {};\n\n      if (showTVIDForm) {\n        const tvFields = getTVFormFields();\n        (0,_utils_functions__WEBPACK_IMPORTED_MODULE_2__.checkoutSendCustomData)(_utils_const__WEBPACK_IMPORTED_MODULE_1__.TV_APP, tvFields);\n        Object.assign(masterdataFields, tvFields);\n      }\n\n      (0,_utils_functions__WEBPACK_IMPORTED_MODULE_2__.saveAddress)(masterdataFields);\n      setTimeout(() => {\n        $('#btn-go-to-payment').trigger('click');\n        saveAddressType();\n      }, _utils_const__WEBPACK_IMPORTED_MODULE_1__.TIMEOUT_750);\n    }\n  };\n\n  const addCustomBtnPayment = () => {\n    if ($('#custom-go-to-payment').length <= 0) {\n      const nativePaymentBtn = $('#btn-go-to-payment');\n      const customPaymentBtn = nativePaymentBtn.clone(false);\n      $(nativePaymentBtn).hide();\n      $(customPaymentBtn).data('bind', '');\n      $(customPaymentBtn).removeAttr('id').attr('id', 'custom-go-to-payment');\n      $(customPaymentBtn).removeAttr('data-bind');\n      $(customPaymentBtn).css('display', 'block');\n      $('p.btn-go-to-payment-wrapper').append(customPaymentBtn);\n      $(customPaymentBtn).on('click', saveShippingForm);\n    }\n  };\n\n  const runCustomization = () => {\n    // If user has no addresses, and has Deliver selected.\n    if ($('div.address-list').length < 1 && $('#shipping-option-delivery').hasClass('shp-method-option-active') && $('body').data('delivery-view') !== 'address-list') {\n      $('body:not(.has-no-addresses)').addClass('has-no-addresses');\n    } else {\n      $('body.has-no-addresses').removeClass('has-no-addresses');\n    }\n\n    if (window.location.hash === _utils_const__WEBPACK_IMPORTED_MODULE_1__.STEPS.SHIPPING) {\n      setTimeout(() => {\n        const selectedDelivery = $('#shipping-option-delivery').hasClass('shp-method-option-active');\n\n        if (selectedDelivery) {\n          addCustomBtnPayment();\n        } // eslint-disable-next-line no-use-before-define\n\n\n        runFormObserver();\n      }, _utils_const__WEBPACK_IMPORTED_MODULE_1__.TIMEOUT_750);\n    }\n  }; // INPUT EVENT SUBSCRIPTION\n\n\n  const runFormObserver = () => {\n    if (state.runningObserver) return;\n    const elementToObserveChange = document.querySelector('.shipping-container .box-step');\n    const observerConfig = {\n      attributes: false,\n      childList: true,\n      characterData: false\n    };\n    const observer = new MutationObserver(() => {\n      state.runningObserver = true;\n\n      if (window.location.hash === _utils_const__WEBPACK_IMPORTED_MODULE_1__.STEPS.SHIPPING && !$('btn-link vtex-omnishipping-1-x-btnDelivery').length) {\n        runCustomization();\n      }\n    });\n\n    if (elementToObserveChange) {\n      observer.observe(elementToObserveChange, observerConfig);\n    }\n  };\n\n  $(document).on('change', '.vtex-omnishipping-1-x-deliveryGroup #tfg-delivery-floor', function () {\n    if ($(this).val() === 'Ground') {\n      $('#tfg-lift-stairs').val('');\n      $('#tfg-lift-stairs').attr('disabled', 'disabled');\n      $('#tfg-lift-stairs').next('span.help.error').remove();\n      $('.tfg-lift-stairs').removeClass('error');\n    } else {\n      $('#tfg-lift-stairs').removeAttr('disabled');\n    }\n  });\n  $(document).on('change', '.vtex-omnishipping-1-x-deliveryGroup .tfg-custom-selector, .vtex-omnishipping-1-x-deliveryGroup .tfg-input', function () {\n    if ($(this).val()) {\n      $(this).parent().removeClass('error');\n      $(this).next('span.help.error').remove();\n      $(this).addClass('tfg-input-completed');\n    } else {\n      $(this).removeClass('tfg-input-completed');\n    }\n  });\n  $(document).on('change keyup', '.vtex-omnishipping-1-x-addressForm input, #tfg-tv-licence', function () {\n    if ($(this).val()) {\n      $(this).parent().removeClass('error');\n      $(this).next('span.help.error').remove();\n    }\n  });\n  $(document).on('change', '.vtex-omnishipping-1-x-deliveryGroup #tfg-rica-same-address', function () {\n    if ($(this).is(':checked')) {\n      (0,_utils_functions__WEBPACK_IMPORTED_MODULE_2__.setRicaFields)('shippingAddress');\n    } else {\n      $('.rica-field').val('');\n    }\n  });\n  $(document).on('click', '#shipping-data .btn-link.vtex-omnishipping-1-x-btnDelivery', () => {\n    runCustomization();\n  }); // EVENTS SUBSCRIPTION\n\n  $(document).ready(() => {\n    runCustomization();\n  });\n  $(window).on('hashchange orderFormUpdated.vtex', () => {\n    runCustomization();\n  });\n  return {\n    state,\n    init: () => {}\n  };\n})();\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (FormController);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/controller/FormController.js?");

/***/ }),

/***/ "./src/controller/ViewController.js":
/*!******************************************!*\
  !*** ./src/controller/ViewController.js ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _partials__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../partials */ \"./src/partials/index.js\");\n/* harmony import */ var _utils_const__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/const */ \"./src/utils/const.js\");\n/* harmony import */ var _utils_functions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/functions */ \"./src/utils/functions.js\");\n\n\n\n\nconst ViewController = (() => {\n  const state = {\n    showFurnitureForm: false,\n    showTVIDForm: false,\n    showRICAForm: false,\n    showTVorRICAMsg: false,\n    showMixedProductsMsg: false,\n    runningObserver: false\n  };\n\n  const checkCartCategories = () => {\n    if (window.vtexjs.checkout.orderForm) {\n      const {\n        items\n      } = window.vtexjs.checkout.orderForm;\n      const {\n        hasFurniture,\n        hasTVs,\n        hasSimCards,\n        categories\n      } = (0,_utils_functions__WEBPACK_IMPORTED_MODULE_2__.getSpecialCategories)(items);\n      state.showTVIDForm = hasTVs;\n      state.showRICAForm = hasSimCards;\n      state.showTVorRICAMsg = state.showTVIDForm || state.showRICAForm;\n      /**\r\n        Conditions to show mixed products alert:\r\n        - more than one item\r\n        - after filter categories, this array includes at least one furniture id\r\n        - there are only one category OR not all the categories in the array are furniture\r\n      */\n\n      state.showMixedProductsMsg = items.length > 1 && hasFurniture && !categories.every(c => c === _utils_const__WEBPACK_IMPORTED_MODULE_1__.FURNITURE_CAT);\n    }\n  };\n\n  const showCustomSections = () => {\n    const tvOrRICAMsgStepExists = $('#tfg-custom-tvrica-msg').length > 0;\n    const mixedProductsMsgExits = $('#tfg-custom-mixed-msg').length > 0;\n    let addBorder = false;\n\n    if (state.showTVorRICAMsg || state.showMixedProductsMsg) {\n      if ($('.vtex-omnishipping-1-x-deliveryChannelsWrapper.custom-disabled').length < 1) {\n        $('#shipping-option-delivery').trigger('click');\n        $('.vtex-omnishipping-1-x-deliveryChannelsWrapper').addClass('custom-disabled');\n      }\n\n      if (state.showTVorRICAMsg && !tvOrRICAMsgStepExists) {\n        $('.vtex-omnishipping-1-x-addressFormPart1').prepend((0,_partials__WEBPACK_IMPORTED_MODULE_0__.TVorRICAMsg)());\n        addBorder = true;\n      }\n\n      if (state.showMixedProductsMsg && !mixedProductsMsgExits) {\n        $('.vtex-omnishipping-1-x-addressFormPart1').prepend((0,_partials__WEBPACK_IMPORTED_MODULE_0__.MixedProducts)());\n        addBorder = true;\n      }\n    }\n\n    if (addBorder) (0,_utils_functions__WEBPACK_IMPORTED_MODULE_2__.addBorderTop)('.tfg-custom-step');\n  };\n\n  const runCustomization = () => {\n    /* Hiding subheader when there is furniture in cart */\n    setTimeout(() => {\n      checkCartCategories();\n\n      if (state.showFurnitureForm) {\n        $('div.subheader').css('display', 'none');\n      } else {\n        $('div.subheader').css('display', 'block');\n      }\n    }, _utils_const__WEBPACK_IMPORTED_MODULE_1__.TIMEOUT_500);\n  };\n\n  const setView = view => {\n    document.body.setAttribute('data-delivery-view', view);\n  }; // EVENTS SUBSCRIPTION\n\n\n  $(document).ready(() => {\n    runCustomization();\n  });\n  $(window).on('hashchange orderFormUpdated.vtex', () => {\n    runCustomization();\n  });\n  $(document).on('click', '#shipping-data .btn-link.vtex-omnishipping-1-x-btnDelivery', () => {\n    runCustomization();\n  });\n  return {\n    state,\n    setView,\n    showCustomSections,\n    init: () => {}\n  };\n})();\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ViewController);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/controller/ViewController.js?");

/***/ }),

/***/ "./src/partials/AddressForm.js":
/*!*************************************!*\
  !*** ./src/partials/AddressForm.js ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"PickupComplementField\": () => (/* binding */ PickupComplementField),\n/* harmony export */   \"SuburbField\": () => (/* binding */ SuburbField),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nconst AddressForm = () => `<p class=\"input custom-field-receiverName tfg-custom-addressForm\">\n      <label>Recipient</label>\n      <input id=\"custom-field-receiverName\" class=\"input-xlarge success\" type=\"text\" field=\"receiverName\" />\n    </p>\n    <p class=\"input custom-field-complement tfg-custom-addressForm\">\n      <label>Mobile number</label>\n      <input id=\"custom-field-complement\" class=\"input-xlarge success\" type=\"text\" field=\"complement\"/>\n    </p>\n    <p class=\"input custom-field-companyBuilding tfg-custom-addressForm\">\n      <label>Company/Building</label>\n      <input id=\"custom-field-companyBuilding\" class=\"input-xlarge success\" type=\"text\" field=\"companyBuilding\"/>\n    </p>\n  `;\n\nconst SuburbField = () => `<p class=\"input custom-field-neighborhood tfg-custom-addressForm\">\n<label>Suburb</label>\n<input id=\"custom-field-neighborhood\" class=\"input-xlarge success\" type=\"text\" field=\"neighborhood\"/>\n</p>`;\nconst PickupComplementField = () => `\n  <p id=\"box-pickup-complement\" class=\"input custom-field-complement tfg-custom-addressForm\">\n    <label>Mobile number</label>\n    <input id=\"custom-pickup-complement\" class=\"input-xlarge success\" type=\"text\" field=\"complement\" placeholder=\"\" />\n  </p>`;\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AddressForm);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/AddressForm.js?");

/***/ }),

/***/ "./src/partials/AlertBox.js":
/*!**********************************!*\
  !*** ./src/partials/AlertBox.js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nconst AlertBox = (message, type) => `\n  <div id=\"tfg-custom-${type}-msg\" class=\"tfg-custom-msg\">\n    <p class=\"tfg-custom-icon\"></p>\n    <p class=\"tfg-custom-text\">${message}</p>\n  </div>\n`;\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AlertBox);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/AlertBox.js?");

/***/ }),

/***/ "./src/partials/Deliver/AddressForm.js":
/*!*********************************************!*\
  !*** ./src/partials/Deliver/AddressForm.js ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _utils_phoneFields__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/phoneFields */ \"./src/utils/phoneFields.js\");\n/* harmony import */ var _Elements_FormField__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Elements/FormField */ \"./src/partials/Deliver/Elements/FormField.js\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ \"./src/partials/Deliver/utils.js\");\n\n\n\n\nconst AddressForm = () => {\n  const fields = [{\n    name: 'addressId',\n    type: 'hidden',\n    value: '',\n    required: false\n  }, {\n    name: 'addressName',\n    type: 'hidden',\n    value: '',\n    required: false,\n    maxLength: 50\n  }, {\n    name: 'street',\n    label: 'Street address',\n    required: true,\n    value: ''\n  }, {\n    name: 'addressType',\n    label: 'Address type',\n    required: true,\n    type: 'radio',\n    options: [{\n      value: 'residential',\n      label: 'Residential',\n      checked: true\n    }, {\n      value: 'business',\n      label: 'Business'\n    }]\n  }, {\n    name: 'number',\n    required: false,\n    value: '  ',\n    type: 'hidden'\n  }, {\n    name: 'companyBuilding',\n    label: 'Building/Complex and number',\n    required: false,\n    value: '',\n    maxLength: 100\n  }, {\n    name: 'neighborhood',\n    label: 'Suburb',\n    value: '',\n    maxLength: 750\n  }, {\n    name: 'city',\n    label: 'City',\n    required: true,\n    value: '',\n    maxLength: 750\n  }, {\n    name: 'postalCode',\n    label: 'Postal code',\n    value: '',\n    type: 'tel',\n    minlength: 4,\n    maxLength: 4\n  }, {\n    type: 'note',\n    required: false,\n    name: 'suburb-postal-reminder',\n    value: 'Make sure to specify the correct Suburb and Postal code so we can easily find your address.'\n  }, {\n    name: 'state',\n    label: 'Province',\n    type: 'dropdown',\n    options: [{\n      value: '',\n      label: 'Select'\n    }, {\n      value: 'EC',\n      label: 'Eastern Cape'\n    }, {\n      value: 'FS',\n      label: 'Free State'\n    }, {\n      value: 'GP',\n      label: 'Gauteng'\n    }, {\n      value: 'KZN',\n      label: 'KwaZulu-Natal'\n    }, {\n      value: 'LP',\n      label: 'Limpopo'\n    }, {\n      value: 'MP',\n      label: 'Mpumalanga'\n    }, {\n      value: 'NC',\n      label: 'Northern Cape'\n    }, {\n      value: 'NW',\n      label: 'North West'\n    }, {\n      value: 'WC',\n      label: 'Western Cape'\n    }]\n  }, {\n    type: 'note',\n    required: false,\n    name: 'country-display',\n    label: 'Country',\n    value: 'South Africa'\n  }, {\n    type: 'hidden',\n    required: true,\n    name: 'country',\n    value: 'ZAF'\n  }, {\n    name: 'receiverName',\n    label: 'Recipient’s name',\n    required: true,\n    value: (0,_utils__WEBPACK_IMPORTED_MODULE_2__.getBestRecipient)()\n  }, {\n    name: 'complement',\n    label: 'Recipient’s mobile number',\n    required: true,\n    value: (0,_utils_phoneFields__WEBPACK_IMPORTED_MODULE_0__.getBestPhoneNumber)(),\n    type: 'tel',\n    helperText: 'We send shipping updates to this number.'\n  }];\n  const formFields = fields.map(field => (0,_Elements_FormField__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(field)).join('');\n  return `\n  <form id=\"bash--address-form\" method=\"post\">\n    ${formFields}\n\n    <button \n      class=\"submit btn-go-to-payment btn btn-large btn-success\"\n      id=\"btn-save-address\" \n      type=\"submit\"\n    >\n      Save address\n    </button>\n  </form>\n  \n  `;\n};\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AddressForm);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/Deliver/AddressForm.js?");

/***/ }),

/***/ "./src/partials/Deliver/AddressListing.js":
/*!************************************************!*\
  !*** ./src/partials/Deliver/AddressListing.js ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _Elements_Radio__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Elements/Radio */ \"./src/partials/Deliver/Elements/Radio.js\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ \"./src/partials/Deliver/utils.js\");\n\n\n\nconst isSelectedAddress = (address, selectedAddress) => {\n  const addressObject = JSON.stringify({\n    street: address.street,\n    neighborhood: address.neighborhood,\n    city: address.city,\n    postalCode: address.postalCode\n  });\n  const selectedAddressObject = JSON.stringify({\n    street: selectedAddress.street,\n    neighborhood: selectedAddress.neighborhood,\n    city: selectedAddress.city,\n    postalCode: selectedAddress.postalCode\n  });\n  return addressObject === selectedAddressObject;\n};\n\nconst AddressListing = address => {\n  if (!address) return '';\n  const {\n    street,\n    neighborhood,\n    postalCode,\n    city,\n    receiverName,\n    complement,\n    addressName\n  } = address;\n  const addressLine = [street, neighborhood ?? city, postalCode].join(', ');\n  const contactLine = [receiverName, (0,_utils__WEBPACK_IMPORTED_MODULE_1__.formatPhoneNumber)((0,_utils__WEBPACK_IMPORTED_MODULE_1__.prependZero)(complement))].join(' - '); // orderform\n\n  const selectedAddress = window?.vtexjs?.checkout?.orderForm?.shippingData?.address;\n  const addressString = encodeURIComponent(JSON.stringify(address));\n  return `\n<label id=\"address-${addressName}\" class=\"bash--address-listing\" data-address=\"${addressString}\">\n  <div class=\"address-radio\">\n  ${(0,_Elements_Radio__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n    name: 'selected-address',\n    options: [{\n      checked: !!selectedAddress ?? isSelectedAddress(address, selectedAddress),\n      value: addressName\n    }]\n  })}\n  </div>\n  <div class=\"address-text\">\n    <div>${addressLine}</div>    \n    <div>${contactLine}</div>  \n  </div>\n  <div class=\"address-edit\">\n    <a href=\"#\" data-view=\"address-edit\" data-content=\"address-${addressName}\">\n      Edit\n    </a>\n  </div>\n</label>\n`;\n};\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AddressListing);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/Deliver/AddressListing.js?");

/***/ }),

/***/ "./src/partials/Deliver/AddressSearch.js":
/*!***********************************************!*\
  !*** ./src/partials/Deliver/AddressSearch.js ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _Elements_FormField__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Elements/FormField */ \"./src/partials/Deliver/Elements/FormField.js\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ \"./src/partials/Deliver/utils.js\");\n\n\n\nconst AddressSearch = () => {\n  setTimeout(() => {\n    (0,_utils__WEBPACK_IMPORTED_MODULE_1__.initGoogleAutocomplete)();\n  }, 500);\n  return (0,_Elements_FormField__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n    name: 'address-search',\n    placeholder: 'Start typing an address...',\n    autoComplete: 'off'\n  });\n};\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AddressSearch);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/Deliver/AddressSearch.js?");

/***/ }),

/***/ "./src/partials/Deliver/Addresses.js":
/*!*******************************************!*\
  !*** ./src/partials/Deliver/Addresses.js ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _utils_functions__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/functions */ \"./src/utils/functions.js\");\n/* harmony import */ var _utils_services__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/services */ \"./src/utils/services.js\");\n/* harmony import */ var _AddressListing__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./AddressListing */ \"./src/partials/Deliver/AddressListing.js\");\n\n\n\n\nconst Addresses = () => {\n  (0,_utils_services__WEBPACK_IMPORTED_MODULE_1__.getAddresses)().then(({\n    data: addresses\n  }) => {\n    const addressesHtml = addresses.map(address => (0,_AddressListing__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(address));\n\n    if (document.getElementById('bash-address-list')) {\n      document.getElementById('bash-address-list').innerHTML = addressesHtml.join('');\n    }\n\n    if ($('#back-button-select-address').hasClass('inactive')) {\n      $('#back-button-select-address').show();\n    }\n\n    (0,_utils_functions__WEBPACK_IMPORTED_MODULE_0__.clearLoaders)();\n\n    if (addresses.length < 1) {\n      window.postMessage({\n        action: 'setDeliveryView',\n        view: 'address-search'\n      });\n      $('#bash--input-address-search').focus();\n      $('#back-button-select-address').hide();\n      $('#back-button-select-address').addClass('inactive');\n    }\n  }).catch(e => {\n    console.error('ERROR getAddresses', e);\n    throw new Error('Error getAddresses', e.message);\n  });\n  return `\n <div class=\"bash--addresses shimmer\" id=\"bash-address-list\">\n    Loading addresses...\n  </div>\n  `;\n};\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Addresses);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/Deliver/Addresses.js?");

/***/ }),

/***/ "./src/partials/Deliver/DeliverContainer.js":
/*!**************************************************!*\
  !*** ./src/partials/Deliver/DeliverContainer.js ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _utils_const__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/const */ \"./src/utils/const.js\");\n/* harmony import */ var _AddressForm__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AddressForm */ \"./src/partials/Deliver/AddressForm.js\");\n/* harmony import */ var _AddressSearch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./AddressSearch */ \"./src/partials/Deliver/AddressSearch.js\");\n/* harmony import */ var _Addresses__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Addresses */ \"./src/partials/Deliver/Addresses.js\");\n/* harmony import */ var _DeliveryError__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./DeliveryError */ \"./src/partials/Deliver/DeliveryError.js\");\n/* harmony import */ var _DeliveryOptions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./DeliveryOptions */ \"./src/partials/Deliver/DeliveryOptions.js\");\n/* harmony import */ var _Elements_Alert__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Elements/Alert */ \"./src/partials/Deliver/Elements/Alert.js\");\n/* harmony import */ var _MixedProducts__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./MixedProducts */ \"./src/partials/Deliver/MixedProducts.js\");\n/* harmony import */ var _TVorRICAMsg__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./TVorRICAMsg */ \"./src/partials/Deliver/TVorRICAMsg.js\");\n\n\n\n\n\n\n\n\n\n\nconst DeliverContainer = ({\n  hasFurn\n}) => `\n  <div class=\"bash--delivery-container\" id=\"bash--delivery-container\" data-view=\"select-address\">\n    <div id=\"bash--shipping-messages\">\n      ${(0,_Elements_Alert__WEBPACK_IMPORTED_MODULE_6__[\"default\"])()}\n      ${(0,_TVorRICAMsg__WEBPACK_IMPORTED_MODULE_8__[\"default\"])()}\n      ${(0,_MixedProducts__WEBPACK_IMPORTED_MODULE_7__[\"default\"])()}\n      ${(0,_DeliveryError__WEBPACK_IMPORTED_MODULE_4__[\"default\"])()}\n    </div>\n   <form id=\"bash--delivery-form\" name=\"bash--delivery-form\" method=\"post\">\n\n    <section class=\"bash--delivery-view\" data-section=\"select-address\">\n    <div class=\"bash--heading\">\n        <h2>Delivery address</h2>\n        <a href=\"#\" data-view=\"address-search\">Add address</a>\n      </div>\n      ${(0,_Addresses__WEBPACK_IMPORTED_MODULE_3__[\"default\"])()}\n    </section>\n\n    <section id=\"bash-delivery-options\" class=\"shipping-method bash--delivery-view\" data-section=\"select-address\">\n      <hr>\n      <div class=\"bash--heading sub-heading\">\n        <h3>Delivery options</h3>\n        ${hasFurn ? _utils_const__WEBPACK_IMPORTED_MODULE_0__.FURNITURE_FEE_LINK : ''}\n      </div>\n      ${(0,_DeliveryOptions__WEBPACK_IMPORTED_MODULE_5__[\"default\"])()}\n      <button \n        class=\"submit btn-go-to-payment btn btn-large btn-success\"\n        id=\"btn-save-delivery\" \n        type=\"submit\">\n          Go to payment\n      </button>\n    </section>\n   </form>\n\n    <section class=\"bash--delivery-view\" data-section=\"address-search\">\n      <div class=\"bash--heading\">\n        <h3>Add a new delivery address</h3>\n        <a href='#' data-view='select-address' id='back-button-select-address'>&lt; Back</a>\n      </div>\n      ${(0,_AddressSearch__WEBPACK_IMPORTED_MODULE_2__[\"default\"])()} \n    </section>\n    \n    <section class=\"bash--delivery-view\" data-section=\"address-form\">\n       <div class=\"bash--heading\">\n        <h3>Delivery address</h3>\n        <a href=\"#\" class=\"back-button--search\" data-view=\"address-search\">&lt; Back</a>\n        <a href=\"#\" class=\"back-button--select\" data-view=\"select-address\">&lt; Back</a>\n      </div>\n      ${(0,_AddressForm__WEBPACK_IMPORTED_MODULE_1__[\"default\"])()}\n    </section>\n    \n  </div>`;\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (DeliverContainer);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/Deliver/DeliverContainer.js?");

/***/ }),

/***/ "./src/partials/Deliver/DeliveryError.js":
/*!***********************************************!*\
  !*** ./src/partials/Deliver/DeliveryError.js ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"DeliveryError\": () => (/* binding */ DeliveryError),\n/* harmony export */   \"DeliveryErrorContainer\": () => (/* binding */ DeliveryErrorContainer),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nconst DeliveryErrorContainer = () => ` \n \n<div id=\"bash-delivery-error-container\"   >\n</div>`;\nconst DeliveryError = ({\n  text,\n  fields\n}) => {\n  if (!fields.itemIndex) return '';\n  const cartItem = window.vtexjs.checkout?.orderForm.items?.[fields.itemIndex];\n  if (!cartItem) return '';\n  const imageUrl = cartItem?.imageUrl;\n  return ` \n<div id=\"bash-delivery-error\" class=\"notification error\" alt=\"${fields?.skuName ?? ''}\" >\n   <!---<div class=\"icon\"></div>--->\n   ${imageUrl ? `<img src=\"${imageUrl}\" style=\" float: right; \" />` : ''}\n   <div class=\"notification-content\">\n      <h3>Address error ${fields?.skuName ? `- ${fields?.skuName}` : ''}</h3>\n      <p>${text}</p>\n      <p>Check the postal code of your address, or \n      <a href=\"#\" \n        class=\"remove-cart-item\"\n        style=\"color: white; text-decoration: underline\"\n        data-index=\"${fields.itemIndex}\">remove this item from your cart</a>.\n      </p>\n   </div>  \n</div>  \n`;\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (DeliveryErrorContainer);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/Deliver/DeliveryError.js?");

/***/ }),

/***/ "./src/partials/Deliver/DeliveryOptions.js":
/*!*************************************************!*\
  !*** ./src/partials/Deliver/DeliveryOptions.js ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _Elements_Radio__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Elements/Radio */ \"./src/partials/Deliver/Elements/Radio.js\");\n\n\nconst DeliveryOptions = () => `\n  <label class=\"bash--delivery-option-display\" >\n  ${(0,_Elements_Radio__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n  name: 'delivery-option',\n  options: [{\n    checked: true,\n    value: true\n  }]\n})}\n   \n   <div id=\"bash--delivery-option-text\" class=\"bash--delivery-option-text\">\n      <span class=\"normal-delivery\">Deliver within 3 - 5 days</span>\n   </div>\n\n  <div id=\"bash--delivery-fee\" class=\"bash--delivery-fee\">\n    R50\n  </div>\n</label>\n  `;\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (DeliveryOptions);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/Deliver/DeliveryOptions.js?");

/***/ }),

/***/ "./src/partials/Deliver/Elements/Alert.js":
/*!************************************************!*\
  !*** ./src/partials/Deliver/Elements/Alert.js ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"Alert\": () => (/* binding */ Alert),\n/* harmony export */   \"AlertContainer\": () => (/* binding */ AlertContainer),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n// message: string\nconst AlertContainer = () => '<div id=\"bash-alert-container\"></div>';\nconst Alert = ({\n  text\n}) => `<div class='alert-container'>\n      <p>${text}</p>\n    </div>\n  `;\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AlertContainer);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/Deliver/Elements/Alert.js?");

/***/ }),

/***/ "./src/partials/Deliver/Elements/Checkbox.js":
/*!***************************************************!*\
  !*** ./src/partials/Deliver/Elements/Checkbox.js ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nconst Checkbox = ({\n  name,\n  label,\n  checked,\n  value\n}) => `\n    <label class=\"tfg-checkbox-label\">\n       <input \n        type='checkbox' \n        name=\"${name}\" \n        id=\"bash--input-${name}\"\n        ${checked ? \"checked='checked'\" : ''}\n        value=${value ?? ''}\n      />\n      <span>${label}</span>\n    </label>\n  `;\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Checkbox);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/Deliver/Elements/Checkbox.js?");

/***/ }),

/***/ "./src/partials/Deliver/Elements/DropDown.js":
/*!***************************************************!*\
  !*** ./src/partials/Deliver/Elements/DropDown.js ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nconst DropDown = ({\n  name,\n  disabled = false,\n  options,\n  required\n}) => {\n  const hasASelectedOption = options.find(option => option.selected === true);\n  return `\n  <select \n    name=\"${name}\" \n    ${required ? ' required ' : ''} \n    ${disabled ? ' disabled ' : ''} \n    id=\"bash--input-${name}\" \n    class=\"input-large\" \n  >\n  ${options.map(({\n    value,\n    label,\n    selected\n  }, index) => `\n    <option \n    ${index === 0 ? ' disabled ' : ''}\n    ${index === 0 && !hasASelectedOption ? ' selected ' : ''}\n    ${selected ? ' selected ' : ''}\n      value=\"${value}\" \n    >${label}</option>\n    `).join('')}\n  </select>\n  `;\n};\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (DropDown);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/Deliver/Elements/DropDown.js?");

/***/ }),

/***/ "./src/partials/Deliver/Elements/FormField.js":
/*!****************************************************!*\
  !*** ./src/partials/Deliver/Elements/FormField.js ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _Checkbox__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Checkbox */ \"./src/partials/Deliver/Elements/Checkbox.js\");\n/* harmony import */ var _DropDown__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./DropDown */ \"./src/partials/Deliver/Elements/DropDown.js\");\n/* harmony import */ var _Note__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Note */ \"./src/partials/Deliver/Elements/Note.js\");\n/* harmony import */ var _Radio__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Radio */ \"./src/partials/Deliver/Elements/Radio.js\");\n/* harmony import */ var _TextField__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./TextField */ \"./src/partials/Deliver/Elements/TextField.js\");\n\n\n\n\n\n\nconst FormField = ({\n  label,\n  name,\n  value = '',\n  required = true,\n  type = 'text',\n  placeholder,\n  autoComplete = 'on',\n  maxLength,\n  minlength,\n  disabled = false,\n  options,\n  checked,\n  error = 'This field is required.'\n}) => {\n  const fieldId = name.replace(/\\s/g, '-');\n\n  const formField = () => {\n    switch (type) {\n      case 'radio':\n        return (0,_Radio__WEBPACK_IMPORTED_MODULE_3__[\"default\"])({\n          name,\n          options\n        });\n\n      case 'dropdown':\n        return (0,_DropDown__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n          name,\n          disabled,\n          options,\n          required\n        });\n\n      case 'note':\n        return (0,_Note__WEBPACK_IMPORTED_MODULE_2__[\"default\"])({\n          name,\n          value\n        });\n\n      case 'checkbox':\n        return (0,_Checkbox__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n          name,\n          label,\n          checked\n        });\n\n      default:\n        return (0,_TextField__WEBPACK_IMPORTED_MODULE_4__[\"default\"])({\n          name,\n          value,\n          required,\n          type,\n          placeholder,\n          autoComplete,\n          maxLength,\n          minlength\n        });\n    }\n  };\n\n  const separateLabel = `<label id=\"bash--label-${fieldId}\" for=\"bash--input-${fieldId}\">${label}</label>`;\n  return `\n<p class=\"input bash--${type}field-${name.replace(/\\s/g, '-')} bash--${type} ${required ? 'required' : 'optional'}\">\n  ${label && type !== 'checkbox' ? separateLabel : ''}\n  ${formField()}\n  <span class=\"bash--field-error\">${error}</span>\n</p>  \n`;\n};\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (FormField);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/Deliver/Elements/FormField.js?");

/***/ }),

/***/ "./src/partials/Deliver/Elements/Note.js":
/*!***********************************************!*\
  !*** ./src/partials/Deliver/Elements/Note.js ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nconst Note = ({\n  value,\n  name\n}) => `\n  <div class=\"bash--note-field ${name}\">\n  ${value}\n  </div>\n  `;\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Note);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/Deliver/Elements/Note.js?");

/***/ }),

/***/ "./src/partials/Deliver/Elements/Radio.js":
/*!************************************************!*\
  !*** ./src/partials/Deliver/Elements/Radio.js ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nconst Radio = ({\n  name,\n  options = []\n}) => `\n  \n  <div class=\"bash--radio-options\">\n  ${options.map(({\n  value,\n  label,\n  checked = false,\n  disabled = false\n}) => `\n      <label class=\"bash--radio-option\" id=\"radio-label-${name}-${value}\">\n        <input type=\"radio\" \n          ${checked ? \"checked='checked'\" : ''} \n          ${disabled ? \"disabled='disabled'\" : ''} \n          value=\"${value ?? ''}\" \n          name=\"${name}\" \n          id=\"radio-${name}-${value}\"\n        />\n          <span class=\"radio-icon\"></span> \n          ${label ? `<span class=\"radio-label\">${label}</span>` : ''}\n      </label>\n    `).join('')}\n   \n  </div>\n  `;\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Radio);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/Deliver/Elements/Radio.js?");

/***/ }),

/***/ "./src/partials/Deliver/Elements/TextField.js":
/*!****************************************************!*\
  !*** ./src/partials/Deliver/Elements/TextField.js ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nconst TextField = ({\n  name,\n  value = '',\n  required = true,\n  type = 'text',\n  placeholder,\n  autoComplete = 'on',\n  minLength = 0,\n  maxLength = 0\n}) => {\n  const fieldId = name.replace(/\\s/g, '-');\n  return `\n  <input \n    ${required ? ' required ' : ''}\n    autocomplete=\"${autoComplete}\" \n    id=\"bash--input-${fieldId}\" \n    type=\"${type}\" \n    name=\"${name}\" \n    ${minLength > 0 ? `minlength=\"${minLength}\"` : ''}\n    ${maxLength > 0 ? `maxlength=\"${maxLength}\"` : ''}\n    placeholder=\"${placeholder ?? ''}\" \n    class=\"input-xlarge\" \n    value=\"${value}\" \n  />\n`;\n};\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (TextField);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/Deliver/Elements/TextField.js?");

/***/ }),

/***/ "./src/partials/Deliver/ExtraFieldsContainer.js":
/*!******************************************************!*\
  !*** ./src/partials/Deliver/ExtraFieldsContainer.js ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _RICAForm__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./RICAForm */ \"./src/partials/Deliver/RICAForm.js\");\n/* harmony import */ var _TVLicenseForm__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TVLicenseForm */ \"./src/partials/Deliver/TVLicenseForm.js\");\n\n\n\nconst ExtraFieldsContainer = ({\n  hasFurn,\n  hasTV,\n  hasSim\n}) => {\n  const showFurnitureForm = `\n    <div id=\"furniture-form\">\n      <hr>\n      <div class=\"bash--heading sub-heading heading-with-description\">\n        <h3>Furniture delivery</h3>\n          Please ensure that there is sufficient space to receive your goods and keep in mind \n          that our couriers aren't able to hoist goods onto balconies.\n      </div>\n    </div>\n  `;\n  const showTVLicenseForm = `\n    <div id=\"tv-license-form\">\n      <hr>\n      <div class=\"bash--heading sub-heading heading-with-description\">\n        <h3>TV license information needed</h3>\n        <p class=\"tfg-custom-subtitle\">Please provide your ID number to validate your TV Licence.</p>\n      </div>\n      ${(0,_TVLicenseForm__WEBPACK_IMPORTED_MODULE_1__[\"default\"])()}\n    </div>\n  `;\n  const showRICAForm = `\n    <div id=\"rica-form\">\n      <hr>\n      <div class=\"bash--heading sub-heading heading-with-description\">\n        <h3>Rica information required</h3>\n        <p class=\"tfg-custom-subtitle\">\n          To RICA your SIM card, provide your SA ID (or foreign passport) number and your address as\n          it appears on a valid proof of residence.\n        </p> \n      </div>\n        ${(0,_RICAForm__WEBPACK_IMPORTED_MODULE_0__[\"default\"])()}\n    </div>\n    `;\n  return `\n  <section class=\"bash--extra-fields bash--delivery-view\" data-section=\"select-address\">\n    ${hasFurn ? showFurnitureForm : ''}\n    ${hasTV ? showTVLicenseForm : ''}\n    ${hasSim ? showRICAForm : ''}\n  </section>`;\n};\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ExtraFieldsContainer);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/Deliver/ExtraFieldsContainer.js?");

/***/ }),

/***/ "./src/partials/Deliver/MixedProducts.js":
/*!***********************************************!*\
  !*** ./src/partials/Deliver/MixedProducts.js ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nconst MixedProducts = () => `\n  <div id=\"tfg-custom-mixed-msg\" class=\"tfg-custom-msg\">\n    <p class=\"tfg-custom-icon\"></p>\n    <p class=\"tfg-custom-text\">\n      We'll ship your furniture and other items in your cart to the selected address. \n      Only the furniture delivery fee will apply.\n      </p>\n  </div>\n`;\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (MixedProducts);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/Deliver/MixedProducts.js?");

/***/ }),

/***/ "./src/partials/Deliver/RICAForm.js":
/*!******************************************!*\
  !*** ./src/partials/Deliver/RICAForm.js ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _Elements_FormField__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Elements/FormField */ \"./src/partials/Deliver/Elements/FormField.js\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ \"./src/partials/Deliver/utils.js\");\n\n\n\nconst RICAForm = () => {\n  const {\n    shippingData: {\n      selectedAddress\n    }\n  } = window.vtexjs.checkout.orderForm; // use rica_ prefix to ensure fields are unique\n\n  const fields = [{\n    name: 'rica_idOrPassport',\n    label: 'ID or Passport number',\n    required: true,\n    value: ''\n  }, {\n    name: 'rica_sameAddress',\n    label: 'Residential address the same as delivery address',\n    type: 'checkbox',\n    checked: true,\n    required: false\n  } // for rest of the fields check if\n  // same as residential address is checked?\n  // if checked prefill the fields otherwise don't\n  ];\n  const conditionalFields = [{\n    name: 'rica_fullName',\n    label: 'Full name and surname',\n    required: true,\n    value: (0,_utils__WEBPACK_IMPORTED_MODULE_1__.getBestRecipient)() || ''\n  }, {\n    name: 'rica_streetAddress',\n    label: 'Street address',\n    required: true,\n    value: selectedAddress?.street || ''\n  }, {\n    name: 'rica_suburb',\n    label: 'Suburb',\n    value: selectedAddress?.neighborhood || ''\n  }, {\n    name: 'rica_city',\n    label: 'City',\n    required: true,\n    value: selectedAddress?.city || ''\n  }, {\n    name: 'rica_postalCode',\n    label: 'Postal code',\n    value: selectedAddress?.postalCode || '',\n    type: 'tel',\n    minlength: 4,\n    maxLength: 4\n  }, {\n    name: 'rica_province',\n    label: 'Province',\n    type: 'dropdown',\n    options: [{\n      value: '',\n      label: 'Select',\n      disabled: true\n    }, {\n      value: 'EC',\n      label: 'Eastern Cape'\n    }, {\n      value: 'FS',\n      label: 'Free State'\n    }, {\n      value: 'GP',\n      label: 'Gauteng'\n    }, {\n      value: 'KZN',\n      label: 'KwaZulu-Natal'\n    }, {\n      value: 'LP',\n      label: 'Limpopo'\n    }, {\n      value: 'MP',\n      label: 'Mpumalanga'\n    }, {\n      value: 'NC',\n      label: 'Northern Cape'\n    }, {\n      value: 'NW',\n      label: 'North West'\n    }, {\n      value: 'WC',\n      label: 'Western Cape'\n    }]\n  }, {\n    type: 'note',\n    required: false,\n    name: 'rica-country-display',\n    label: 'Country',\n    value: 'South Africa'\n  }, {\n    type: 'hidden',\n    required: true,\n    name: 'country',\n    value: 'ZAF'\n  }];\n  const formFields = fields.map(field => (0,_Elements_FormField__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(field)).join('');\n  const conditionalFormFields = conditionalFields.map(field => (0,_Elements_FormField__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(field)).join('');\n  return `\n    ${formFields}\n    <div class=\"rica-conditional-fields hide\">\n    ${conditionalFormFields}\n    </div>\n  `;\n};\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (RICAForm);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/Deliver/RICAForm.js?");

/***/ }),

/***/ "./src/partials/Deliver/TVLicenseForm.js":
/*!***********************************************!*\
  !*** ./src/partials/Deliver/TVLicenseForm.js ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _Elements_FormField__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Elements/FormField */ \"./src/partials/Deliver/Elements/FormField.js\");\n\n\nconst TVLicenseForm = () => {\n  // use tv_ prefix to ensure fields are unique\n  const field = {\n    name: 'tv_tvID',\n    label: 'SA ID number',\n    required: true,\n    value: ''\n  };\n  return `\n    ${(0,_Elements_FormField__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(field)}\n  `;\n};\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (TVLicenseForm);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/Deliver/TVLicenseForm.js?");

/***/ }),

/***/ "./src/partials/Deliver/TVorRICAMsg.js":
/*!*********************************************!*\
  !*** ./src/partials/Deliver/TVorRICAMsg.js ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nconst TVorRICAMsg = () => `\n  <div id=\"tfg-custom-tvrica-msg\" class=\"tfg-custom-msg\">\n    <p class=\"tfg-custom-icon\"></p>\n    <p class=\"tfg-custom-text\">\n      You can't collect this order in store because your cart contains items \n      which require either RICA or TV License validation.\n    </p>\n  </div>\n`;\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (TVorRICAMsg);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/Deliver/TVorRICAMsg.js?");

/***/ }),

/***/ "./src/partials/Deliver/constants.js":
/*!*******************************************!*\
  !*** ./src/partials/Deliver/constants.js ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"requiredAddressFields\": () => (/* binding */ requiredAddressFields),\n/* harmony export */   \"requiredRicaFields\": () => (/* binding */ requiredRicaFields),\n/* harmony export */   \"requiredTVFields\": () => (/* binding */ requiredTVFields),\n/* harmony export */   \"validAddressTypes\": () => (/* binding */ validAddressTypes)\n/* harmony export */ });\n/* eslint-disable import/prefer-default-export */\nconst requiredAddressFields = ['receiverName', 'complement', 'street', 'neighborhood', 'state', 'city', 'country', 'postalCode'];\nconst requiredRicaFields = ['idOrPassport', 'sameAddress', 'fullName', 'streetAddress', 'suburb', 'city', 'postalCode', 'province'];\nconst requiredTVFields = ['tvID'];\nconst validAddressTypes = ['residential', 'inStore', 'commercial', 'giftRegistry', 'pickup', 'search'];\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/Deliver/constants.js?");

/***/ }),

/***/ "./src/partials/Deliver/utils.js":
/*!***************************************!*\
  !*** ./src/partials/Deliver/utils.js ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"addressIsValid\": () => (/* binding */ addressIsValid),\n/* harmony export */   \"clearRicaFields\": () => (/* binding */ clearRicaFields),\n/* harmony export */   \"customShippingDataIsValid\": () => (/* binding */ customShippingDataIsValid),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   \"formatPhoneNumber\": () => (/* binding */ formatPhoneNumber),\n/* harmony export */   \"getBestRecipient\": () => (/* binding */ getBestRecipient),\n/* harmony export */   \"initGoogleAutocomplete\": () => (/* binding */ initGoogleAutocomplete),\n/* harmony export */   \"mapGoogleAddress\": () => (/* binding */ mapGoogleAddress),\n/* harmony export */   \"parseAttribute\": () => (/* binding */ parseAttribute),\n/* harmony export */   \"populateAddressForm\": () => (/* binding */ populateAddressForm),\n/* harmony export */   \"populateDeliveryError\": () => (/* binding */ populateDeliveryError),\n/* harmony export */   \"populateExtraFields\": () => (/* binding */ populateExtraFields),\n/* harmony export */   \"populateRicaFields\": () => (/* binding */ populateRicaFields),\n/* harmony export */   \"populateTVFields\": () => (/* binding */ populateTVFields),\n/* harmony export */   \"preparePhoneField\": () => (/* binding */ preparePhoneField),\n/* harmony export */   \"prependZero\": () => (/* binding */ prependZero),\n/* harmony export */   \"setAddress\": () => (/* binding */ setAddress),\n/* harmony export */   \"setCartClasses\": () => (/* binding */ setCartClasses),\n/* harmony export */   \"setDeliveryLoading\": () => (/* binding */ setDeliveryLoading),\n/* harmony export */   \"setPickupLoading\": () => (/* binding */ setPickupLoading),\n/* harmony export */   \"showAlertBox\": () => (/* binding */ showAlertBox),\n/* harmony export */   \"showHideLiftOrStairs\": () => (/* binding */ showHideLiftOrStairs),\n/* harmony export */   \"submitAddressForm\": () => (/* binding */ submitAddressForm),\n/* harmony export */   \"submitDeliveryForm\": () => (/* binding */ submitDeliveryForm),\n/* harmony export */   \"updateDeliveryFeeDisplay\": () => (/* binding */ updateDeliveryFeeDisplay)\n/* harmony export */ });\n/* harmony import */ var _utils_const__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/const */ \"./src/utils/const.js\");\n/* harmony import */ var _utils_functions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/functions */ \"./src/utils/functions.js\");\n/* harmony import */ var _utils_services__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/services */ \"./src/utils/services.js\");\n/* harmony import */ var _DeliveryError__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./DeliveryError */ \"./src/partials/Deliver/DeliveryError.js\");\n/* harmony import */ var _Elements_Alert__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Elements/Alert */ \"./src/partials/Deliver/Elements/Alert.js\");\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./constants */ \"./src/partials/Deliver/constants.js\");\n\n\n\n\n\n\nconst setDeliveryLoading = () => {\n  document.querySelector('.bash--delivery-container').classList.add('shimmer');\n};\nconst setPickupLoading = () => {\n  document.querySelector('.delivery-group-content')?.classList?.add('shimmer');\n  document.querySelector('.vtex-omnishipping-1-x-ask')?.classList?.add('shimmer');\n};\nconst mapGoogleAddress = (addressComponents, geometry) => {\n  const streetNumber = addressComponents.find(item => item.types.includes('street_number'))?.long_name;\n  const street = addressComponents.find(item => item.types.includes('route'))?.long_name;\n  const neighborhood = addressComponents.find(item => item.types.includes('sublocality'))?.long_name;\n  const city = addressComponents.find(item => item.types.includes('locality'))?.long_name;\n  const postalCode = addressComponents.find(item => item.types.includes('postal_code'))?.long_name;\n  const state = addressComponents.find(item => item.types.includes('administrative_area_level_1'))?.long_name;\n  const coords = {\n    lat: '',\n    lng: ''\n  };\n\n  if (geometry) {\n    coords.lat = geometry.location.lat();\n    coords.lng = geometry.location.lng();\n  }\n\n  return {\n    street: `${streetNumber ?? ''} ${street ?? ''}`.trim(),\n    neighborhood,\n    city,\n    postalCode,\n    state,\n    ...coords\n  };\n};\n\nconst provinceShortCode = province => {\n  switch (province) {\n    case 'Select':\n      return '';\n\n    case 'Western Cape':\n      return 'WC';\n\n    case 'Easter Cape':\n      return 'EC';\n\n    case 'Gauteng':\n      return 'GP';\n\n    case 'KwaZulu-Natal':\n    case 'KwaZulu Natal':\n      return 'KZN';\n\n    case 'Northern Cape':\n      return 'NC';\n\n    case 'Limpopo':\n      return 'LP';\n\n    case 'Mpumalanga':\n      return 'MP';\n\n    case 'North West':\n      return 'NW';\n\n    case 'Freestate':\n    case 'Free State':\n      return 'FS';\n\n    default:\n      return province;\n  }\n};\n\nconst getBestRecipient = () => {\n  const receiverName = window?.vtexjs?.checkout?.orderForm?.shippingData?.address?.receiverName;\n  const firstName = window?.vtexjs?.checkout?.orderForm?.clientProfileData?.firstName;\n  const lastName = window?.vtexjs?.checkout?.orderForm?.clientProfileData?.lastName;\n  const clientProfileName = `${firstName ?? ''} ${lastName ?? ''}`.trim();\n  return receiverName || document.getElementById('client-first-name')?.value || clientProfileName;\n};\n\nconst populateAddressFromSearch = address => {\n  const {\n    street,\n    neighborhood,\n    postalCode,\n    state,\n    city\n  } = address; // Clear any populated fields\n\n  document.getElementById('bash--address-form').reset(); // Clear hidden ID fields to prevent overwriting existing.\n\n  document.getElementById('bash--input-addressId').value = '';\n  document.getElementById('bash--input-addressName').value = '';\n  document.getElementById('bash--input-number').value = '  ';\n  document.getElementById('bash--input-street').value = street ?? '';\n  document.getElementById('bash--input-neighborhood').value = neighborhood ?? '';\n  document.getElementById('bash--input-city').value = city ?? '';\n  document.getElementById('bash--input-postalCode').value = postalCode ?? '';\n  document.getElementById('bash--input-state').value = provinceShortCode(state);\n};\n\nconst populateAddressForm = address => {\n  const {\n    street,\n    companyBuilding,\n    neighborhood,\n    postalCode,\n    state,\n    city,\n    receiverName,\n    complement,\n    id,\n    addressId,\n    addressName\n  } = address; // Clear any populated fields\n\n  document.getElementById('bash--address-form').reset(); // Only overwrite defaults if values exist.\n\n  if (receiverName) document.getElementById('bash--input-receiverName').value = receiverName ?? '';\n  if (complement) document.getElementById('bash--input-complement').value = complement ?? ''; // addressId indicates that address is being edited / completed.\n\n  if (id || addressId) document.getElementById('bash--input-addressId').value = id || addressId; // TODO remove this?\n\n  if (addressName) document.getElementById('bash--input-addressName').value = addressName;\n  document.getElementById('bash--input-number').value = '';\n  document.getElementById('bash--input-companyBuilding').value = companyBuilding ?? '';\n  document.getElementById('bash--input-street').value = street ?? '';\n  document.getElementById('bash--input-neighborhood').value = neighborhood ?? '';\n  document.getElementById('bash--input-city').value = city ?? '';\n  document.getElementById('bash--input-postalCode').value = postalCode ?? '';\n  document.getElementById('bash--input-state').value = provinceShortCode(state);\n  $(':invalid').trigger('change');\n};\nconst initGoogleAutocomplete = () => {\n  if (!window.google) return;\n  const input = document.getElementById('bash--input-address-search');\n  const autocomplete = new window.google.maps.places.Autocomplete(input, {\n    componentRestrictions: {\n      country: 'ZA'\n    }\n  });\n  window.google.maps.event.addListener(autocomplete, 'place_changed', () => {\n    const place = autocomplete.getPlace();\n    const {\n      address_components: addressComponents,\n      geometry\n    } = place;\n    const address = mapGoogleAddress(addressComponents, geometry); // Populate the form\n    // Set view to add-address\n\n    populateAddressFromSearch(address);\n    window.postMessage({\n      action: 'setDeliveryView',\n      view: 'address-form'\n    });\n    input.value = '';\n  });\n};\nconst parseAttribute = data => JSON.parse(decodeURIComponent(data));\nconst populateExtraFields = (address, fields, prefix = '', override = false) => {\n  if (!address) return;\n\n  for (let i = 0; i < fields.length; i++) {\n    const fieldId = `bash--input-${prefix}${fields[i]}`;\n\n    if (document.getElementById(fieldId) && (address[fields[i]] || override) && (!document.getElementById(fieldId).value || override)) {\n      document.getElementById(fieldId).value = address[fields[i]];\n    }\n  }\n\n  $(':invalid').trigger('change');\n};\nconst populateRicaFields = () => {\n  const {\n    address\n  } = window.vtexjs.checkout.orderForm.shippingData;\n  if (document.getElementById('bash--input-rica_streetAddress')?.value || !address) return;\n  address.fullName = getBestRecipient();\n  address.streetAddress = address.street;\n  address.suburb = address.neighborhood;\n  address.province = address.state;\n  populateExtraFields(address, _constants__WEBPACK_IMPORTED_MODULE_5__.requiredRicaFields, 'rica_');\n  const data = (0,_utils_services__WEBPACK_IMPORTED_MODULE_2__.getOrderFormCustomData)(_utils_const__WEBPACK_IMPORTED_MODULE_0__.RICA_APP);\n  if (data.streetAddress) populateExtraFields(data, _constants__WEBPACK_IMPORTED_MODULE_5__.requiredRicaFields, 'rica_', true);\n};\nconst clearRicaFields = () => {\n  const idOrPassport = $('#bash--input-rica_idOrPassport').val();\n  const clearedRica = {\n    idOrPassport: idOrPassport ?? '',\n    // TODO populate with users ID\n    fullName: '',\n    streetAddress: '',\n    suburb: '',\n    city: '',\n    postalCode: '',\n    province: ''\n  };\n  populateExtraFields(clearedRica, _constants__WEBPACK_IMPORTED_MODULE_5__.requiredRicaFields, 'rica_', true);\n};\nconst showHideLiftOrStairs = floor => {\n  if (floor && floor !== 'ground') {\n    $('.bash--dropdownfield-liftOrStairs').slideDown().addClass('required');\n    $('#bash--input-liftOrStairs').attr('required', 'required');\n  } else {\n    $('.bash--dropdownfield-liftOrStairs').slideUp();\n    $('#bash--input-liftOrStairs').removeAttr('required');\n  }\n};\nconst populateTVFields = async () => {\n  const data = (0,_utils_services__WEBPACK_IMPORTED_MODULE_2__.getOrderFormCustomData)(_utils_const__WEBPACK_IMPORTED_MODULE_0__.TV_APP);\n  populateExtraFields(data, _constants__WEBPACK_IMPORTED_MODULE_5__.requiredTVFields, 'tv');\n}; // Runs when you setAddress\n\nconst addressIsValid = (address, validateExtraFields = true) => {\n  const {\n    items\n  } = window.vtexjs.checkout.orderForm;\n  const {\n    hasTVs,\n    hasSimCards\n  } = (0,_utils_functions__WEBPACK_IMPORTED_MODULE_1__.getSpecialCategories)(items);\n  let requiredFields = [];\n  const invalidFields = [];\n  requiredFields = [..._constants__WEBPACK_IMPORTED_MODULE_5__.requiredAddressFields];\n\n  if (hasTVs && validateExtraFields) {\n    requiredFields = [...requiredFields, ..._constants__WEBPACK_IMPORTED_MODULE_5__.requiredTVFields];\n  }\n\n  if (hasSimCards && validateExtraFields) {\n    requiredFields = [...requiredFields, ..._constants__WEBPACK_IMPORTED_MODULE_5__.requiredRicaFields];\n  }\n\n  for (let i = 0; i < requiredFields.length; i++) {\n    if (!address[requiredFields[i]]) invalidFields.push(requiredFields[i]);\n  }\n\n  return {\n    isValid: !invalidFields.length,\n    invalidFields\n  };\n};\nconst setCartClasses = () => {\n  const {\n    items\n  } = window.vtexjs.checkout.orderForm;\n  const {\n    hasTVs,\n    hasSimCards,\n    hasFurnitureMixed\n  } = (0,_utils_functions__WEBPACK_IMPORTED_MODULE_1__.getSpecialCategories)(items);\n  const $container = '#shipping-data';\n\n  if (hasTVs) {\n    $(`${$container}:not(.has-tv)`).addClass('has-tv');\n  } else {\n    $(`${$container}.has-tv`).removeClass('has-tv');\n  }\n\n  if (hasSimCards) {\n    $(`${$container}:not(.has-rica)`).addClass('has-rica');\n  } else {\n    $(`${$container}.has-rica`).removeClass('has-rica');\n  }\n\n  if (hasFurnitureMixed) {\n    $(`${$container}:not(.has-furniture-mixed)`).addClass('has-furniture-mixed');\n  } else {\n    $(`${$container}.has-furniture-mixed`).removeClass('has-furniture-mixed');\n  }\n};\nconst updateDeliveryFeeDisplay = () => {\n  if (!window.vtexjs.checkout.orderForm.totalizers) return;\n  const {\n    value: shippingFee\n  } = window.vtexjs.checkout.orderForm.totalizers.find(item => item.id === 'Shipping') || {\n    value: 5000\n  };\n  let feeText = 'Free';\n  if (shippingFee > 0) feeText = `R${(shippingFee / 100).toFixed(2).replace('.00', '')}`;\n\n  if ($('#bash--delivery-fee').length > 0) {\n    document.getElementById('bash--delivery-fee').innerHTML = feeText;\n  }\n};\nconst customShippingDataIsValid = () => {\n  const items = window.vtexjs.checkout.orderForm?.items;\n  const {\n    hasTVs,\n    hasSimCards\n  } = (0,_utils_functions__WEBPACK_IMPORTED_MODULE_1__.getSpecialCategories)(items);\n  let valid = true;\n\n  if (hasTVs) {\n    const data = (0,_utils_services__WEBPACK_IMPORTED_MODULE_2__.getOrderFormCustomData)(_utils_const__WEBPACK_IMPORTED_MODULE_0__.TV_APP);\n    if (!data.tvID) valid = false;\n  }\n\n  if (hasSimCards) {\n    const data = (0,_utils_services__WEBPACK_IMPORTED_MODULE_2__.getOrderFormCustomData)(_utils_const__WEBPACK_IMPORTED_MODULE_0__.RICA_APP);\n    if (!data.idOrPassport || !data.streetAddress || !data.postalCode) valid = false;\n  }\n\n  return valid;\n};\nconst populateDeliveryError = (errors = []) => {\n  if ($('#bash-delivery-error-container').length < 1) return;\n  const errorsHtml = errors.length > 0 ? errors.map(error => (0,_DeliveryError__WEBPACK_IMPORTED_MODULE_3__.DeliveryError)(error)) : '';\n  $('#bash-delivery-error-container').html(errorsHtml);\n  if (errors.length > 0) $('html, body').animate({\n    scrollTop: $('#bash-delivery-error-container').offset().top\n  }, 400);\n}; // TODO move somewhere else?\n\nconst setAddress = (address, options = {\n  validateExtraFields: true\n}) => {\n  const {\n    validateExtraFields\n  } = options;\n  const {\n    items\n  } = window.vtexjs.checkout.orderForm;\n  const {\n    hasTVs,\n    hasSimCards\n  } = (0,_utils_functions__WEBPACK_IMPORTED_MODULE_1__.getSpecialCategories)(items);\n  if (hasTVs) populateExtraFields(address, _constants__WEBPACK_IMPORTED_MODULE_5__.requiredTVFields, 'tv_');\n  if (hasSimCards) populateRicaFields();\n  const {\n    isValid,\n    invalidFields\n  } = addressIsValid(address, validateExtraFields);\n\n  if (!isValid) {\n    populateAddressForm(address);\n    $('#bash--address-form').addClass('show-form-errors');\n    if (validateExtraFields) $('#bash--delivery-form')?.addClass('show-form-errors');\n    $(`#bash--input-${invalidFields[0]}`).focus();\n\n    if (_constants__WEBPACK_IMPORTED_MODULE_5__.requiredAddressFields.includes(invalidFields[0])) {\n      window.postMessage({\n        action: 'setDeliveryView',\n        view: 'address-edit'\n      });\n    }\n\n    return {\n      success: false,\n      error: 'Invalid address details.'\n    };\n  } // Fix bad addressType.\n\n\n  if (address.addressType === 'business') address.addressType = 'commercial';\n  if (!_constants__WEBPACK_IMPORTED_MODULE_5__.validAddressTypes.includes(address.addressType)) address.addressType = 'residential';\n  const {\n    shippingData\n  } = window?.vtexjs?.checkout?.orderForm;\n  shippingData.address = address;\n  shippingData.address.number = shippingData.address.number ?? ' ';\n  shippingData.selectedAddresses = [address]; // Start Shimmering\n\n  setDeliveryLoading();\n  return window.vtexjs.checkout.sendAttachment('shippingData', shippingData).then(orderForm => {\n    const {\n      messages\n    } = orderForm;\n    const errors = messages.filter(msg => msg.status === 'error');\n\n    if (errors.length > 0) {\n      populateDeliveryError(errors);\n      window.postMessage({\n        action: 'setDeliveryView',\n        view: 'address-form'\n      });\n      return {\n        success: false,\n        errors\n      };\n    }\n\n    if (address.addressName) (0,_utils_services__WEBPACK_IMPORTED_MODULE_2__.updateAddressListing)(shippingData.address);\n    return {\n      success: true\n    };\n  }).done(() => (0,_utils_functions__WEBPACK_IMPORTED_MODULE_1__.clearLoaders)());\n};\nconst showAlertBox = () => {\n  $('.alert-container').addClass('show');\n  $('.alert-container').slideDown();\n  const alertText = $('[data-view=\"address-form\"]').length > 0 ? 'Address added' : 'Address updated';\n  $('#bash-alert-container').html((0,_Elements_Alert__WEBPACK_IMPORTED_MODULE_4__.Alert)({\n    text: alertText\n  })); // After 5 seconds, remove the element\n\n  setTimeout(() => {\n    $('.alert-container').slideUp();\n  }, 5000);\n};\nconst submitAddressForm = async event => {\n  event.preventDefault(); // Prevent false positive for invalid selects.\n\n  $('select').change();\n  const form = document.forms['bash--address-form'];\n  const addressName = $('#bash--input-addressName').val();\n  const storedAddress = await (0,_utils_services__WEBPACK_IMPORTED_MODULE_2__.getAddressByName)(addressName);\n  const fields = ['addressId', 'addressName', 'addressType', 'receiverName', 'postalCode', 'city', 'state', 'country', 'street', 'neighborhood', 'complement', 'companyBuilding'];\n  const address = {\n    isDisposable: false,\n    reference: null,\n    geoCoordinates: [],\n    number: '',\n    country: 'ZAF',\n    ...storedAddress\n  };\n\n  for (let f = 0; f < fields.length; f++) {\n    address[fields[f]] = form[fields[f]]?.value || null;\n  }\n\n  address.addressName = address.addressName || address.addressId;\n  address.addressId = address.addressId || address.addressName;\n  const {\n    isValid,\n    invalidFields\n  } = addressIsValid(address, false);\n\n  if (!isValid) {\n    console.error({\n      invalidFields\n    });\n    $('#bash--address-form').addClass('show-form-errors');\n    $(`#bash--input-${invalidFields[0]}`).focus();\n\n    if (_constants__WEBPACK_IMPORTED_MODULE_5__.requiredAddressFields.includes(invalidFields[0])) {\n      window.postMessage({\n        action: 'setDeliveryView',\n        view: 'address-form'\n      });\n    }\n\n    return;\n  } // Apply the selected address to customers orderForm.\n\n\n  const setAddressResponse = await setAddress(address, {\n    validateExtraFields: false\n  });\n  const {\n    success\n  } = setAddressResponse;\n\n  if (!success) {\n    console.error('Set address error', {\n      setAddressResponse\n    });\n    return;\n  } // Update the localstore, and the API\n\n\n  await (0,_utils_services__WEBPACK_IMPORTED_MODULE_2__.addOrUpdateAddress)(address);\n  window.postMessage({\n    action: 'setDeliveryView',\n    view: 'select-address'\n  });\n  showAlertBox();\n};\nconst submitDeliveryForm = async event => {\n  event.preventDefault();\n  const {\n    items\n  } = window.vtexjs.checkout.orderForm;\n  const {\n    address\n  } = window.vtexjs.checkout.orderForm.shippingData;\n  const {\n    hasTVs,\n    hasSimCards\n  } = (0,_utils_functions__WEBPACK_IMPORTED_MODULE_1__.getSpecialCategories)(items); // Prevent false positive validation errors for invalid selects.\n\n  $('select').change();\n  let fullAddress = {};\n  const selectedAddressRadio = \"[name='selected-address']:checked\"; // Prevent sending without having selected an address.\n\n  if ($(selectedAddressRadio).length < 1) {\n    $('html, body').animate({\n      scrollTop: $('#bash--delivery-form').offset().top\n    }, 400);\n    return;\n  }\n\n  setDeliveryLoading();\n  const dbAddress = await (0,_utils_services__WEBPACK_IMPORTED_MODULE_2__.getAddressByName)($(selectedAddressRadio).val());\n  fullAddress = { ...address,\n    ...dbAddress\n  }; // Final check to validate that the selected address has no validation errors.\n\n  const {\n    success: didSetAddress\n  } = await setAddress(fullAddress, {\n    validateExtraFields: false\n  });\n\n  if (!didSetAddress) {\n    console.error('Delivery Form - Address Validation error');\n    (0,_utils_functions__WEBPACK_IMPORTED_MODULE_1__.clearLoaders)();\n    return;\n  }\n\n  const ricaData = {};\n  const tvData = {}; // Not saved to address profile.\n\n  if (hasSimCards) {\n    const fields = _constants__WEBPACK_IMPORTED_MODULE_5__.requiredRicaFields;\n\n    for (let i = 0; i < fields.length; i++) {\n      if (fields[i] === 'sameAddress') {\n        const isFieldChecked = $(`#bash--input-${fields[i]}`).is(':checked');\n        ricaData[fields[i]] = isFieldChecked;\n      }\n\n      ricaData[fields[i]] = $(`#bash--input-rica_${fields[i]}`).val() || '';\n    }\n\n    const ricaDataSent = await (0,_utils_services__WEBPACK_IMPORTED_MODULE_2__.sendOrderFormCustomData)(_utils_const__WEBPACK_IMPORTED_MODULE_0__.RICA_APP, ricaData, true);\n    console.info({\n      ricaDataSent\n    });\n  }\n\n  if (hasTVs) {\n    const fields = _constants__WEBPACK_IMPORTED_MODULE_5__.requiredTVFields;\n\n    for (let i = 0; i < fields.length; i++) {\n      if (!address[fields[i]]) fullAddress[fields[i]] = $(`#bash--input-tv_${fields[i]}`).val();\n      tvData[fields[i]] = $(`#bash--input-tv_${fields[i]}`).val() || '';\n    }\n\n    const tvDataSent = await (0,_utils_services__WEBPACK_IMPORTED_MODULE_2__.sendOrderFormCustomData)(_utils_const__WEBPACK_IMPORTED_MODULE_0__.TV_APP, tvData);\n    console.info({\n      tvDataSent\n    });\n  }\n\n  await (0,_utils_services__WEBPACK_IMPORTED_MODULE_2__.addOrUpdateAddress)(fullAddress); // after submitting hide the delivery container\n\n  $('.bash--delivery-container').css('display', 'none');\n  window.location.hash = _utils_const__WEBPACK_IMPORTED_MODULE_0__.STEPS.PAYMENT;\n  (0,_utils_functions__WEBPACK_IMPORTED_MODULE_1__.clearLoaders)();\n}; // some presaved addresses still have a missing zero,\n// this adds a zero to the phone number, if it's not there.\n\nconst prependZero = tel => {\n  let phoneNumber = tel.replace(/\\s/g, '');\n\n  if (phoneNumber.length === 9 && phoneNumber[0] !== '0') {\n    phoneNumber = `0${phoneNumber}`;\n  }\n\n  return phoneNumber;\n}; // add spaces between 3rd and 6th digit\n\nconst formatPhoneNumber = value => [value.slice(0, 3), value.slice(3, 6), value.slice(6)].join(' ');\n/**\n * formattedPhoneNumber\n * Add spaces to help guide the user how the number should look.\n * Adds space after 3rd and 6th digits only.\n * xxx xxx xxxxxxxxx\n * @param value - string value\n * @returns string\n */\n\nconst formattedPhoneNumber = (value, isBackSpace) => {\n  value = value.replace(/[^0-9+*#]+/g, '').trim(); // Eg. 072 123 4567\n\n  if (value[0] === '0') {\n    if (value.length >= 6) {\n      // 'xxx xxx *'\n      const newValue = [value.slice(0, 3), value.slice(3, 6), value.slice(6)].join(' ');\n      return isBackSpace ? newValue.trim() : newValue;\n    } // 'xxx *'\n\n\n    if (value.length >= 3) {\n      const newValue = [value.slice(0, 3), value.slice(3)].join(' ');\n      return isBackSpace ? newValue.trim() : newValue;\n    } // Eg. 72 123 4567\n\n  } else {\n    if (value.length >= 5) {\n      // 'xx xxx *'\n      const newValue = [value.slice(0, 2), value.slice(2, 5), value.slice(5)].join(' ');\n      return isBackSpace ? newValue.trim() : newValue;\n    } // 'xx *'\n\n\n    if (value.length >= 2) {\n      const newValue = [value.slice(0, 2), value.slice(2)].join(' ');\n      return isBackSpace ? newValue.trim() : newValue;\n    }\n  }\n\n  if (isBackSpace) return value.trim();\n  return value;\n};\n/**\n * preparePhoneField\n * When phone fields are loaded onto the DOM\n * Prepare them for proper display and validation.\n *\n * @param  input - string css selector to the element.\n */\n\n\nconst preparePhoneField = input => {\n  const phoneInput = document.querySelector(input);\n  if (!phoneInput) return;\n  phoneInput.setAttribute('maxlength', 12);\n  phoneInput.value = formattedPhoneNumber(phoneInput.value);\n  $(document).off('keyup', input); // preventbubble\n\n  $(document).on('keyup', input, function (e) {\n    const $phoneInput = $(this);\n    const value = $phoneInput.val().replace(/[^0-9+*#]+/g, '');\n    const isBackSpace = e.keyCode === 8;\n    const displayValue = formattedPhoneNumber(value, isBackSpace);\n    $phoneInput.parent('.text').removeClass('error');\n    $phoneInput.parent('.text').find('span.error').hide();\n    $phoneInput.val(displayValue);\n  });\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (mapGoogleAddress);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/Deliver/utils.js?");

/***/ }),

/***/ "./src/partials/InputError.js":
/*!************************************!*\
  !*** ./src/partials/InputError.js ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nconst InputError = () => '<span class=\"help error\">This field is required.</span>';\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (InputError);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/InputError.js?");

/***/ }),

/***/ "./src/partials/RICAForm.js":
/*!**********************************!*\
  !*** ./src/partials/RICAForm.js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nconst RICAForm = () => `\n  <div id=\"tfg-custom-rica-msg\" class=\"tfg-custom-step\">\n    <p class=\"tfg-custom-title\">RICA information required</p>\n    <p class=\"tfg-custom-subtitle\">\n      To RICA your SIM card, provide your SA ID (or foreign passport) number and your address as\n      it appears on a valid proof of residence.\n    </p>\n    <p class=\"input tfg-custom-input tfg-rica-id-passport\">\n      <label>ID or passport number</label>\n      <input id=\"tfg-rica-id-passport\" type=\"text\" class=\"input-xlarge tfg-input\">\n    </p>\n    <label class=\"tfg-mtop10\">Proof of residential address</label>\n    <p class=\"tfg-custom-checkbox\">\n      <label class=\"tfg-checkbox-label\">\n        <input type='checkbox' id=\"tfg-rica-same-address\" checked/>\n        <span class=\"tfg-checkbox-text\">Residential address the same as Delivery address</span>\n      </label>\n    </p>\n    <p class=\"input tfg-custom-input tfg-rica-fullname\">\n      <label>Full name and surname</label>\n      <input id=\"tfg-rica-fullname\" type=\"text\" class=\"input-xlarge tfg-input rica-field\">\n    </p>\n    <p class=\"input tfg-custom-input tfg-rica-street\">\n      <label>Street address</label>\n      <input id=\"tfg-rica-street\" type=\"text\" class=\"input-xlarge tfg-input rica-field\">\n    </p>\n    <p class=\"input tfg-custom-input tfg-rica-suburb\">\n      <label>Suburb</label>\n      <input id=\"tfg-rica-suburb\" type=\"text\" class=\"input-xlarge tfg-input rica-field\">\n    </p>\n    <p class=\"input tfg-custom-input tfg-rica-city\">\n      <label>City</label>\n      <input id=\"tfg-rica-city\" type=\"text\" class=\"input-xlarge tfg-input rica-field\">\n    </p>\n    <p class=\"input tfg-custom-input tfg-rica-postal-code\">\n      <label>Postal code</label>\n      <input id=\"tfg-rica-postal-code\" type=\"text\" class=\"input-xlarge tfg-input rica-field\">\n    </p>\n    <p class=\"input tfg-rica-province tfg-custom-input\">\n      <label>Province</label>\n      <select class=\"input-xlarge tfg-custom-selector rica-field\" id=\"tfg-rica-province\">\n        <option value=\"\" disabled selected>State</option>\n        <option value=\"EC\">Eastern Cape</option>\n        <option value=\"FS\">Free State</option>\n        <option value=\"GP\">Gauteng</option>\n        <option value=\"KZN\">KwaZulu-Natal</option>\n        <option value=\"LP\">Limpopo</option>\n        <option value=\"MP\">Mpumalanga</option>\n        <option value=\"NC\">Northern Cape</option>\n        <option value=\"NW\">North West</option>\n        <option value=\"WC\">Western Cape</option>\n      </select>\n    </p>\n    <p class=\"input tfg-rica-country tfg-custom-input\">\n      <label>Country</label>\n      <select class=\"input-xlarge tfg-custom-selector\" id=\"tfg-rica-country\" disabled>\n        <option value=\"ZAF\" selected>South Africa</option>\n      </select>\n    </p>\n  </div>\n`;\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (RICAForm);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/RICAForm.js?");

/***/ }),

/***/ "./src/partials/TVIDForm.js":
/*!**********************************!*\
  !*** ./src/partials/TVIDForm.js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nconst TVIDForm = () => `\n    <div id=\"tfg-custom-tvid-step\" class=\"tfg-custom-step\">\n        <p class=\"tfg-custom-title\">TV licence required</p>\n        <p class=\"tfg-custom-subtitle\">Please provide your ID number to validate your TV Licence.</p>\n        <p class=\"input tfg-custom-input tfg-tv-licence\">\n            <label>SA ID number</label>\n            <input id=\"tfg-tv-licence\" type=\"tel\" class=\"input-xlarge tfg-input\">\n        </p>\n    </div>\n`;\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (TVIDForm);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/TVIDForm.js?");

/***/ }),

/***/ "./src/partials/index.js":
/*!*******************************!*\
  !*** ./src/partials/index.js ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"AddressForm\": () => (/* reexport safe */ _AddressForm__WEBPACK_IMPORTED_MODULE_0__[\"default\"]),\n/* harmony export */   \"AlertBox\": () => (/* reexport safe */ _AlertBox__WEBPACK_IMPORTED_MODULE_1__[\"default\"]),\n/* harmony export */   \"InputError\": () => (/* reexport safe */ _InputError__WEBPACK_IMPORTED_MODULE_4__[\"default\"]),\n/* harmony export */   \"MixedProducts\": () => (/* reexport safe */ _Deliver_MixedProducts__WEBPACK_IMPORTED_MODULE_2__[\"default\"]),\n/* harmony export */   \"PickupComplementField\": () => (/* reexport safe */ _AddressForm__WEBPACK_IMPORTED_MODULE_0__.PickupComplementField),\n/* harmony export */   \"RICAForm\": () => (/* reexport safe */ _RICAForm__WEBPACK_IMPORTED_MODULE_5__[\"default\"]),\n/* harmony export */   \"SuburbField\": () => (/* reexport safe */ _AddressForm__WEBPACK_IMPORTED_MODULE_0__.SuburbField),\n/* harmony export */   \"TVIDForm\": () => (/* reexport safe */ _TVIDForm__WEBPACK_IMPORTED_MODULE_6__[\"default\"]),\n/* harmony export */   \"TVorRICAMsg\": () => (/* reexport safe */ _Deliver_TVorRICAMsg__WEBPACK_IMPORTED_MODULE_3__[\"default\"])\n/* harmony export */ });\n/* harmony import */ var _AddressForm__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AddressForm */ \"./src/partials/AddressForm.js\");\n/* harmony import */ var _AlertBox__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AlertBox */ \"./src/partials/AlertBox.js\");\n/* harmony import */ var _Deliver_MixedProducts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Deliver/MixedProducts */ \"./src/partials/Deliver/MixedProducts.js\");\n/* harmony import */ var _Deliver_TVorRICAMsg__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Deliver/TVorRICAMsg */ \"./src/partials/Deliver/TVorRICAMsg.js\");\n/* harmony import */ var _InputError__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./InputError */ \"./src/partials/InputError.js\");\n/* harmony import */ var _RICAForm__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./RICAForm */ \"./src/partials/RICAForm.js\");\n/* harmony import */ var _TVIDForm__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./TVIDForm */ \"./src/partials/TVIDForm.js\");\n\n\n\n\n\n\n\n\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/partials/index.js?");

/***/ }),

/***/ "./src/utils/checkoutDB.js":
/*!*********************************!*\
  !*** ./src/utils/checkoutDB.js ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nclass CheckoutDB {\n  constructor() {\n    this.indexedDB = window.indexedDB || window.webkitIndexedDB || window.mozIndexedDB || window.msIndexedDB || window.shimIndexedDB;\n    this.checkoutDB = indexedDB.open('checkoutDB', 1.2);\n\n    this.checkoutDB.onerror = event => {\n      console.error('CheckoutDB Error', {\n        event\n      });\n      throw new Error('Could not load checkoutDB');\n    };\n\n    this.checkoutDB.onupgradeneeded = () => {\n      const db = this.checkoutDB.result;\n      const store = db.createObjectStore('addresses', {\n        keyPath: 'addressName'\n      });\n      store.createIndex('address_street', ['street'], {\n        unique: false\n      });\n      store.createIndex('address_addressName', ['addressName'], {\n        unique: true\n      });\n      store.createIndex('address_street_suburb_city_postal', ['street', 'neighborhood', 'city', 'postalCode'], {\n        unique: true\n      });\n    };\n\n    this.checkoutDB.onsuccess = () => {\n      const db = this.checkoutDB.result;\n      const transaction = db.transaction('addresses', 'readwrite');\n      this.addresses = transaction.objectStore('addresses'); // Close DB connection\n\n      transaction.oncomplete = () => {// db.close();\n      };\n    };\n  }\n\n  store() {\n    const db = this.checkoutDB.result;\n    const transaction = db.transaction('addresses', 'readwrite');\n    return transaction.objectStore('addresses');\n  }\n\n  loadAddresses(addresses) {\n    const queries = addresses.map(address => this.addOrUpdateAddress(address));\n    return Promise.all(queries).then(values => values);\n  }\n\n  addOrUpdateAddress(address) {\n    const thisDb = this;\n    return new Promise((resolve, reject) => {\n      const query = thisDb.store().put(address);\n\n      query.onsuccess = () => {\n        resolve({\n          success: true,\n          addressId: query.result\n        });\n      };\n\n      query.onerror = error => {\n        reject(new Error({\n          sucess: false,\n          error: error?.target?.error\n        }));\n      };\n    });\n  }\n\n  getAddresses() {\n    const thisDb = this;\n    return new Promise(resolve => {\n      const query = thisDb.store().getAll();\n\n      query.onsuccess = () => resolve(query.result);\n\n      query.onerror = () => {\n        console.error('Something wrong with getAddresses ? ...');\n        resolve([]);\n      };\n    });\n  }\n\n  getAddress(id) {\n    const thisDb = this;\n    return new Promise(resolve => {\n      const query = thisDb.store().get(id);\n\n      query.onsuccess = () => resolve(query.result);\n\n      query.onerror = () => {\n        console.error('Something wrong with getAddress ? ...');\n        resolve([]);\n      };\n    });\n  }\n\n  deleteAddress(id) {\n    const query = this.addresses.delete(id);\n\n    query.onsuccess = () => query.result;\n  }\n\n  clearData() {\n    const thisDb = this;\n    return new Promise(resolve => {\n      const query = thisDb.store().clear();\n\n      query.onsuccess = () => resolve(query.result);\n\n      query.onerror = () => {\n        console.error('Something wrong with clearData ? ...');\n        resolve([]);\n      };\n    });\n  }\n\n}\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (CheckoutDB);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/utils/checkoutDB.js?");

/***/ }),

/***/ "./src/utils/const.js":
/*!****************************!*\
  !*** ./src/utils/const.js ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"AD_TYPE\": () => (/* binding */ AD_TYPE),\n/* harmony export */   \"BASE_URL_API\": () => (/* binding */ BASE_URL_API),\n/* harmony export */   \"COUNTRIES\": () => (/* binding */ COUNTRIES),\n/* harmony export */   \"COUNTRIES_AVAILABLES\": () => (/* binding */ COUNTRIES_AVAILABLES),\n/* harmony export */   \"FURNITURE_CAT\": () => (/* binding */ FURNITURE_CAT),\n/* harmony export */   \"FURNITURE_FEES\": () => (/* binding */ FURNITURE_FEES),\n/* harmony export */   \"FURNITURE_FEE_LINK\": () => (/* binding */ FURNITURE_FEE_LINK),\n/* harmony export */   \"GEOLOCATE\": () => (/* binding */ GEOLOCATE),\n/* harmony export */   \"MANUAL\": () => (/* binding */ MANUAL),\n/* harmony export */   \"NONE\": () => (/* binding */ NONE),\n/* harmony export */   \"PICKUP\": () => (/* binding */ PICKUP),\n/* harmony export */   \"RICA_APP\": () => (/* binding */ RICA_APP),\n/* harmony export */   \"SIM_CAT\": () => (/* binding */ SIM_CAT),\n/* harmony export */   \"STEPS\": () => (/* binding */ STEPS),\n/* harmony export */   \"TIMEOUT_500\": () => (/* binding */ TIMEOUT_500),\n/* harmony export */   \"TIMEOUT_750\": () => (/* binding */ TIMEOUT_750),\n/* harmony export */   \"TV_APP\": () => (/* binding */ TV_APP),\n/* harmony export */   \"TV_CAT\": () => (/* binding */ TV_CAT)\n/* harmony export */ });\n// Checkout steps\nconst STEPS = {\n  CART: '#/cart',\n  PROFILE: '#/profile',\n  SHIPPING: '#/shipping',\n  PAYMENT: '#/payment'\n}; // Address types\n\nconst AD_TYPE = {\n  PICKUP: 'search',\n  DELIVERY: 'residential'\n}; // TIMEOUT\n\nconst TIMEOUT_500 = 500;\nconst TIMEOUT_750 = 750; // PICKUP MAP STATES\n\nconst GEOLOCATE = 'geolocate';\nconst MANUAL = 'manual';\nconst PICKUP = 'pickup';\nconst NONE = 'none'; // APP CONFIGURATION IDs\n\nconst RICA_APP = 'ricafields';\nconst TV_APP = 'tvfields'; // Furniture fees Url\n\nconst FURNITURE_FEES = 'http://image.tfgmedia.co.za/image/1/process/500x790?source=http://cdn.tfgmedia.co.za' + '/15/Marketing/HTMLPages/Furniture_Delivery_Fees_tab_image.jpg';\nconst COUNTRIES = {\n  za: {\n    code: 'za',\n    phonePlaceholder: '(+27)'\n  } // South Africa\n\n};\nconst COUNTRIES_AVAILABLES = [COUNTRIES.za.code];\nconst BASE_URL_API = window.location.host.includes('bash.com') ? 'https://store-api.www.bash.com/custom-api/' : `${window.location.protocol}//${window.location.host}/custom-api/`;\nconst FURNITURE_FEE_LINK = `\n<a \n  href=\"${FURNITURE_FEES}\"\n  class=\"furniture-fees-link\" \n  target=\"_blank\"\n>\n  Furniture delivery costs\n</a>\n`;\nconst FURNITURE_CAT = '1169288799';\nconst TV_CAT = '938942995';\nconst SIM_CAT = '24833302';\n\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/utils/const.js?");

/***/ }),

/***/ "./src/utils/functions.js":
/*!********************************!*\
  !*** ./src/utils/functions.js ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"addBorderTop\": () => (/* binding */ addBorderTop),\n/* harmony export */   \"checkoutGetCustomData\": () => (/* binding */ checkoutGetCustomData),\n/* harmony export */   \"checkoutSendCustomData\": () => (/* binding */ checkoutSendCustomData),\n/* harmony export */   \"clearLoaders\": () => (/* binding */ clearLoaders),\n/* harmony export */   \"getShippingData\": () => (/* binding */ getShippingData),\n/* harmony export */   \"getSpecialCategories\": () => (/* binding */ getSpecialCategories),\n/* harmony export */   \"isValidNumberBash\": () => (/* binding */ isValidNumberBash),\n/* harmony export */   \"saveAddress\": () => (/* binding */ saveAddress),\n/* harmony export */   \"setMasterdataFields\": () => (/* binding */ setMasterdataFields),\n/* harmony export */   \"setRicaFields\": () => (/* binding */ setRicaFields),\n/* harmony export */   \"waitAndResetLocalStorage\": () => (/* binding */ waitAndResetLocalStorage)\n/* harmony export */ });\n/* harmony import */ var _const__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./const */ \"./src/utils/const.js\");\n/* harmony import */ var _phoneFields__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./phoneFields */ \"./src/utils/phoneFields.js\");\n\n // API Functions\n\nconst catchError = message => {\n  console.error('ERROR', message);\n  throw new Error(message);\n};\n\nconst getHeadersByConfig = ({\n  cookie,\n  cache,\n  json\n}) => {\n  const headers = new Headers();\n  if (cookie) headers.append('Cookie', document?.cookie);\n  if (cache) headers.append('Cache-Control', 'no-cache');\n  if (json) headers.append('Content-type', 'application/json');\n  return headers;\n}; // TODO remove when no longer used in favour of services.\n\n\nconst getShippingData = async (addressName, fields) => {\n  let data = {};\n  const headers = getHeadersByConfig({\n    cookie: true,\n    cache: true,\n    json: false\n  });\n  const options = {\n    headers,\n    credentials: 'include'\n  };\n  const response = await fetch(`${_const__WEBPACK_IMPORTED_MODULE_0__.BASE_URL_API}masterdata/addresses/${fields}&_where=addressName=${addressName}&timestamp=${Date.now()}`, options).then(res => res.json()).catch(error => catchError(`GET_ADDRESS_ERROR: ${error?.message}`));\n\n  if (response && !response.error && response.data && response.data.length > 0) {\n    [data] = response.data;\n  }\n\n  return data;\n}; // TODO remove when no longer used in favour of services.\n\n\nconst saveAddress = async (fields = {}) => {\n  let path;\n  const {\n    email\n  } = window.vtexjs.checkout.orderForm.clientProfileData;\n  const {\n    address\n  } = window.vtexjs.checkout.orderForm.shippingData;\n  if (!address) return; // Address already exists (?)\n\n  const savedAddress = address?.addressId ? await getShippingData(address.addressId, '?_fields=id') : {}; // Guardado del nuevo addressType\n\n  address.addressType = localStorage.getItem('addressType');\n\n  if (savedAddress?.id) {\n    path = `${_const__WEBPACK_IMPORTED_MODULE_0__.BASE_URL_API}masterdata/address/${savedAddress.id}`;\n  } else {\n    path = `${_const__WEBPACK_IMPORTED_MODULE_0__.BASE_URL_API}masterdata/addresses`;\n  }\n\n  address.complement = address.complement || (0,_phoneFields__WEBPACK_IMPORTED_MODULE_1__.getBestPhoneNumber)(); // Importante respetar el orden de address para no sobreescribir receiver, complement y neighborhood\n\n  const newAddress = {\n    userId: email,\n    ...address,\n    ...fields\n  };\n\n  if (!savedAddress.id) {\n    newAddress.addressName = address.addressId;\n  }\n\n  const headers = getHeadersByConfig({\n    cookie: true,\n    cache: true,\n    json: true\n  });\n  const options = {\n    method: 'PATCH',\n    headers,\n    body: JSON.stringify(newAddress),\n    credentials: 'include'\n  };\n  await fetch(path, options).then(res => {\n    localStorage.setItem('shippingDataCompleted', true);\n\n    if (res.status !== 204) {\n      res.json();\n    }\n  }).catch(error => catchError(`SAVE_ADDRESS_ERROR: ${error?.message}`));\n};\n\nconst setMasterdataFields = async (completeFurnitureForm, completeTVIDForm, tries = 1) => {\n  /* Data will only be searched and set if any of the custom fields for TFG are displayed. */\n  if (completeFurnitureForm || completeTVIDForm) {\n    const {\n      address\n    } = window.vtexjs.checkout.orderForm.shippingData;\n    /* Setting Masterdata custom fields */\n\n    const fields = '?_fields=buildingType,parkingDistance,deliveryFloor,liftOrStairs,hasSufficientSpace,assembleFurniture,tvID';\n    const shippingData = await getShippingData(address.addressId, fields);\n\n    if (shippingData && !jQuery.isEmptyObject(shippingData)) {\n      /* Setting furniture form values */\n      if (completeFurnitureForm) {\n        $('#tfg-building-type').val(shippingData.buildingType);\n        $('#tfg-parking-distance').val(shippingData.parkingDistance);\n        $('#tfg-delivery-floor').val(shippingData.deliveryFloor);\n\n        if ($('#tfg-delivery-floor').val() === 'Ground') {\n          $('#tfg-lift-stairs').attr('disabled', 'disabled');\n        } else {\n          $('#tfg-lift-stairs').val(shippingData.liftOrStairs);\n        }\n\n        $('#tfg-sufficient-space').prop('checked', shippingData.hasSufficientSpace);\n        $('#tfg-assemble-furniture').prop('checked', shippingData.assembleFurniture);\n      }\n      /* Setting TV form values */\n\n\n      if (completeTVIDForm) {\n        $('#tfg-tv-licence').val(shippingData.tvID);\n      }\n    } else if (tries <= 5) {\n      setTimeout(() => {\n        setMasterdataFields(completeFurnitureForm, completeTVIDForm, tries += 1);\n      }, 3000);\n    }\n  }\n}; // Functions to manage CustomData\n\n\nconst checkoutGetCustomData = appId => {\n  const {\n    customData\n  } = window.vtexjs.checkout.orderForm;\n  let fields = {};\n\n  if (customData && customData.customApps && customData.customApps.length > 0) {\n    customData.customApps.forEach(app => {\n      if (app.id === appId) {\n        fields = app.fields;\n      }\n    });\n  }\n\n  return fields;\n};\n\nconst checkoutSendCustomData = (appId, customData) => {\n  const {\n    orderFormId\n  } = window.vtexjs.checkout.orderForm;\n  return $.ajax({\n    type: 'PUT',\n    url: `/api/checkout/pub/orderForm/${orderFormId}/customData/${appId}`,\n    dataType: 'json',\n    contentType: 'application/json; charset=utf-8',\n    data: JSON.stringify(customData)\n  });\n};\n\nconst setRicaFields = (getDataFrom = 'customApps') => {\n  let ricaFields;\n\n  if (getDataFrom === 'shippingAddress') {\n    const {\n      address\n    } = window.vtexjs.checkout.orderForm.shippingData;\n    ricaFields = {\n      idOrPassport: '',\n      sameAddress: 'true',\n      fullName: address.receiverName || $('#ship-receiverName').val(),\n      streetAddress: `${address.street}, ${address.number}`,\n      suburb: address.neighborhood,\n      city: address.city,\n      postalCode: address.postalCode,\n      province: address.state\n    };\n  } else if (getDataFrom === 'customApps') {\n    ricaFields = checkoutGetCustomData(_const__WEBPACK_IMPORTED_MODULE_0__.RICA_APP);\n  }\n\n  if (ricaFields && !jQuery.isEmptyObject(ricaFields)) {\n    if (getDataFrom === 'customApps') {\n      $('#tfg-rica-id-passport').val(ricaFields.idOrPassport);\n      $('#tfg-rica-same-address').prop('checked', ricaFields.sameAddress === 'true');\n    }\n\n    $('#tfg-rica-fullname').val(ricaFields.fullName);\n    $('#tfg-rica-street').val(ricaFields.streetAddress);\n    $('#tfg-rica-suburb').val(ricaFields.suburb);\n    $('#tfg-rica-city').val(ricaFields.city);\n    $('#tfg-rica-postal-code').val(ricaFields.postalCode);\n    $('#tfg-rica-province').val(ricaFields.province);\n  }\n}; // Random Functions\n\n\nconst addBorderTop = elementClass => {\n  $(elementClass).addClass('custom-step-border');\n  $(elementClass).last().addClass('last-custom-step-border');\n};\n\nconst waitAndResetLocalStorage = () => {\n  setTimeout(() => {\n    localStorage.removeItem('shippingDataCompleted');\n  }, 5000);\n};\n\nconst isValidNumberBash = tel => (0,_phoneFields__WEBPACK_IMPORTED_MODULE_1__.validatePhoneNumber)(tel);\n\nconst getSpecialCategories = items => {\n  const furnitureCategories = [_const__WEBPACK_IMPORTED_MODULE_0__.FURNITURE_CAT];\n  const tvCategories = [_const__WEBPACK_IMPORTED_MODULE_0__.TV_CAT];\n  const simCardCategories = [_const__WEBPACK_IMPORTED_MODULE_0__.SIM_CAT];\n  const categories = [];\n  let hasTVs = false;\n  let hasSimCards = false;\n  let hasFurniture = false;\n  let hasFurnitureMixed = false;\n  items.forEach(item => {\n    const itemCategories = item.productCategoryIds.split('/');\n    categories.push(itemCategories);\n    itemCategories.forEach(category => {\n      if (!category) return;\n      if (tvCategories.includes(category)) hasTVs = true;\n      if (simCardCategories.includes(category)) hasSimCards = true;\n      if (furnitureCategories.includes(category)) hasFurniture = true;\n    });\n  });\n  hasFurnitureMixed = items.length > 1 && hasFurniture && !categories.every(c => c === _const__WEBPACK_IMPORTED_MODULE_0__.FURNITURE_CAT);\n  return {\n    hasFurniture,\n    hasSimCards,\n    hasTVs,\n    hasFurnitureMixed,\n    categories\n  };\n};\n\nconst clearLoaders = () => {\n  'happened';\n  $('.shimmer').removeClass('shimmer');\n};\n\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/utils/functions.js?");

/***/ }),

/***/ "./src/utils/phoneFields.js":
/*!**********************************!*\
  !*** ./src/utils/phoneFields.js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   \"getBestPhoneNumber\": () => (/* binding */ getBestPhoneNumber),\n/* harmony export */   \"preparePhoneField\": () => (/* binding */ preparePhoneField),\n/* harmony export */   \"validatePhoneNumber\": () => (/* binding */ validatePhoneNumber)\n/* harmony export */ });\n/**\n * validatePhoneNumber\n * Determine if number is valid.\n * Numbers and spaces only, 9 digits or longer.\n * @param tel - string\n * @returns boolean\n */\nconst validatePhoneNumber = tel => {\n  if (!tel) return false;\n  tel = tel.replace(/\\s/g, '');\n  if (tel[0] === '0') return tel.match(/[0-9\\s]{10}/);\n  return tel.match(/[0-9\\s]{9,}/);\n};\n/**\n * formattedPhoneNumber\n * Add spaces to help guide the user how the number should look.\n * Adds space after 3rd and 6th digits only.\n * xxx xxx xxxxxxxxx\n * @param value - string value\n * @returns string\n */\n\nconst formattedPhoneNumber = (value, doFormat = true) => {\n  value = value.replace(/[^0-9+*#]+/g, '').trim(); // 'xxx xxx *'\n\n  if (value.length >= 6 && doFormat) {\n    return [value.slice(0, 3), value.slice(3, 6), value.slice(6)].join(' ');\n  } // 'xxx *'\n\n\n  if (value.length >= 3 && doFormat) {\n    return [value.slice(0, 3), value.slice(3)].join(' ');\n  }\n\n  return value;\n};\n/**\n * preparePhoneField\n * When phone fields are loaded onto the DOM\n * Prepare them for proper display and validation.\n *\n * @param  input - string css selector to the element.\n */\n\n\nconst preparePhoneField = input => {\n  const phoneInput = document.querySelector(input);\n  if (!phoneInput) return;\n  phoneInput.setAttribute('type', 'tel');\n  phoneInput.setAttribute('maxlength', 12);\n  phoneInput.value = formattedPhoneNumber(phoneInput.value);\n  const $phoneInput = $(input);\n  $phoneInput.keyup(e => {\n    const value = e.currentTarget.value.replace(/[^0-9+*#]+/g, '').trim();\n    let displayValue = value;\n    const isBackSpace = e.keyCode === 8;\n    displayValue = formattedPhoneNumber(value, !isBackSpace);\n    $phoneInput.parent('.text').removeClass('error');\n    $phoneInput.parent('.text').find('span.error').hide();\n    $phoneInput.val(displayValue);\n  });\n};\nconst getBestPhoneNumber = () => window.vtexjs.checkout.orderForm?.shippingData?.address?.complement || window.vtexjs.checkout.orderForm?.clientProfileData?.phone || document?.getElementById('client-phone')?.value;\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n  validatePhoneNumber\n});\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/utils/phoneFields.js?");

/***/ }),

/***/ "./src/utils/services.js":
/*!*******************************!*\
  !*** ./src/utils/services.js ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"addOrUpdateAddress\": () => (/* binding */ addOrUpdateAddress),\n/* harmony export */   \"clearAddresses\": () => (/* binding */ clearAddresses),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   \"getAddressByName\": () => (/* binding */ getAddressByName),\n/* harmony export */   \"getAddresses\": () => (/* binding */ getAddresses),\n/* harmony export */   \"getOrderFormCustomData\": () => (/* binding */ getOrderFormCustomData),\n/* harmony export */   \"removeFromCart\": () => (/* binding */ removeFromCart),\n/* harmony export */   \"sendOrderFormCustomData\": () => (/* binding */ sendOrderFormCustomData),\n/* harmony export */   \"updateAddressListing\": () => (/* binding */ updateAddressListing),\n/* harmony export */   \"upsertAddress\": () => (/* binding */ upsertAddress)\n/* harmony export */ });\n/* harmony import */ var _partials_Deliver_AddressListing__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../partials/Deliver/AddressListing */ \"./src/partials/Deliver/AddressListing.js\");\n/* harmony import */ var _checkoutDB__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./checkoutDB */ \"./src/utils/checkoutDB.js\");\n/* harmony import */ var _const__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./const */ \"./src/utils/const.js\");\n/* harmony import */ var _functions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./functions */ \"./src/utils/functions.js\");\n/* harmony import */ var _phoneFields__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./phoneFields */ \"./src/utils/phoneFields.js\");\n/* eslint-disable no-new-wrappers */\n\n\n\n\n // API Functions\n\nconst catchError = message => {\n  console.error('ERROR', message);\n  throw new Error(message);\n};\n\nconst getHeadersByConfig = ({\n  cookie,\n  cache,\n  json\n}) => {\n  const headers = new Headers(); // TODO don't use document?.cookie\n\n  if (cookie) headers.append('Cookie', document?.cookie);\n  if (cache) headers.append('Cache-Control', 'no-cache');\n  if (json) headers.append('Content-type', 'application/json');\n  return headers;\n}; // GET addresses\n\n\nconst DB = new _checkoutDB__WEBPACK_IMPORTED_MODULE_1__[\"default\"]();\nconst getAddresses = async () => {\n  // Try to get addresses from users local store.\n  // TODO: When should addresses be reloaded/updated?\n  const addresses = await DB.getAddresses();\n  if (addresses.length > 0) return {\n    data: addresses\n  }; // Fallback to get addresses from API.\n\n  return window.vtexjs.checkout.getOrderForm().then(orderForm => {\n    const {\n      email\n    } = orderForm?.clientProfileData;\n    const fields = ['id', 'addressType', 'addressQuery', 'addressName', 'reference', 'number', 'geolocation', 'receiverName', 'complement', 'companyBuilding', 'street', 'neighborhood', 'city', 'postalCode', 'state', 'country', 'tvID'].join(',');\n    const headers = getHeadersByConfig({\n      cookie: true,\n      cache: true,\n      json: false\n    });\n    const options = {\n      headers,\n      credentials: 'include'\n    };\n    const cacheBust = Date.now();\n    return fetch(`${_const__WEBPACK_IMPORTED_MODULE_2__.BASE_URL_API}masterdata/addresses?t=${cacheBust}&_fields=${fields}&_where=${encodeURIComponent(`userIdQuery=${email}`)}`, options).then(res => res.json()).then(async data => {\n      // Store addresses locally\n      if (data.data) DB.loadAddresses(data.data); // return DB.getAddresses();\n      // API can have dups.\n\n      return data;\n    }).catch(error => catchError(`GET_ADDRESSES_ERROR: ${error?.message}`));\n  });\n}; // GET Address by ID / Name?\n\nconst getAddress = async (addressName, fields) => {\n  let data = {};\n  const headers = getHeadersByConfig({\n    cookie: true,\n    cache: true,\n    json: false\n  });\n  const options = {\n    headers,\n    credentials: 'include'\n  };\n  const response = await fetch(`${_const__WEBPACK_IMPORTED_MODULE_2__.BASE_URL_API}masterdata/addresses/${fields}&_where=addressName=${addressName}&timestamp=${Date.now()}`, options).then(res => res.json()).catch(error => catchError(`GET_ADDRESS_ERROR: ${error?.message}`));\n\n  if (response && !response.error && response.data && response.data.length > 0) {\n    [data] = response.data;\n  }\n\n  return data;\n}; // PATCH address\n\n\nconst upsertAddress = async address => {\n  let path;\n  const {\n    email\n  } = window.vtexjs.checkout.orderForm.clientProfileData;\n  if (!address) return Promise.reject(new Error('No address provided.')); // Address already exists (?) - ID keeps channging?\n\n  const existingAddress = address.addressName ? await getAddress(address.addressName, '?_fields=id') : {};\n\n  if (existingAddress?.id) {\n    path = `${_const__WEBPACK_IMPORTED_MODULE_2__.BASE_URL_API}masterdata/address/${existingAddress.id}`;\n  } else {\n    path = `${_const__WEBPACK_IMPORTED_MODULE_2__.BASE_URL_API}masterdata/addresses`;\n  }\n\n  address.complement = address.complement || (0,_phoneFields__WEBPACK_IMPORTED_MODULE_4__.getBestPhoneNumber)(); // Importante respetar el orden de address para no sobreescribir receiver, complement y neighborhood\n\n  const newAddress = {\n    userId: email,\n    ...address\n  };\n\n  if (!existingAddress.id) {\n    newAddress.addressName = address.addressId || `address-${Date.now()}`;\n  }\n\n  const headers = getHeadersByConfig({\n    cookie: true,\n    cache: true,\n    json: true\n  });\n  const options = {\n    method: 'PATCH',\n    headers,\n    body: JSON.stringify(newAddress),\n    credentials: 'include'\n  };\n  await fetch(path, options).then(res => {\n    if (res.status !== 204) {\n      return res.json();\n    }\n\n    return res;\n  }).then(result => result).catch(error => catchError(`SAVE_ADDRESS_ERROR: ${error?.message}`));\n};\nconst updateAddressListing = address => {\n  let $currentListing = $(`#address-${address.addressName}`);\n\n  if (!$currentListing.length) {\n    $('#bash-address-list').append((0,_partials_Deliver_AddressListing__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(address));\n  } else {\n    $currentListing.after((0,_partials_Deliver_AddressListing__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(address));\n    $currentListing.remove();\n    $currentListing = null;\n  }\n\n  $('input[type=\"radio\"][name=\"selected-address\"]:checked').attr('checked', false);\n  $(`input[type=\"radio\"][name=\"selected-address\"][value=\"${address.addressName}\"]`).attr('checked', true);\n};\nconst addOrUpdateAddress = async address => {\n  if (!address.addressName) {\n    const streetStr = address.street.replace(/[^a-zA-Z0-9]/g, ' ').trim().replace(/\\s/g, '-').toLowerCase();\n    address.addressName = `${Date.now()}-${streetStr}`.substring(0, 50);\n  }\n\n  if (!address.addressId) address.addressId = address.addressName; // Add or update at local store. Update UI.\n\n  DB.addOrUpdateAddress(address).then(() => updateAddressListing(address)); // Add or update at the API.\n\n  upsertAddress(address);\n};\nconst getAddressByName = async addressName => DB.getAddress(addressName);\nconst clearAddresses = async () => DB.clearData();\n/**\n * OrderForm CustomData\n * @param {Object} data - custom data.\n * @param {string} appId - unique app id.\n * @param {boolean} furniture - boolean value for sending furniture.\n * @param {boolean} rica - boolean value for sending rica fields.\n */\n\nconst sendOrderFormCustomData = async (appId, data, rica = false) => {\n  const {\n    orderFormId\n  } = window.vtexjs.checkout.orderForm;\n  const path = `/api/checkout/pub/orderForm/${orderFormId}/customData/${appId}`;\n  const body = JSON.stringify({ ...data,\n    ...(rica && {\n      sameAddress: new Boolean(data.sameAddress)\n    })\n  });\n  const options = {\n    method: 'PUT',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body\n  };\n  return fetch(path, options);\n};\nconst getOrderFormCustomData = appId => {\n  const {\n    customData\n  } = window.vtexjs.checkout.orderForm;\n  let fields = {};\n\n  if (customData && customData.customApps && customData.customApps.length > 0) {\n    customData.customApps.forEach(app => {\n      if (app.id === appId) {\n        fields = app.fields;\n      }\n    });\n  }\n\n  return fields;\n};\nconst removeFromCart = index => window.vtexjs.checkout.updateItems([{\n  index: `${index}`,\n  quantity: 0\n}]).then(orderForm => {\n  console.info('ITEM REMOVED', {\n    orderForm\n  });\n}).done(() => {\n  (0,_functions__WEBPACK_IMPORTED_MODULE_3__.clearLoaders)();\n});\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (getAddresses);\n\n//# sourceURL=webpack://custom-shipping-step-by-items/./src/utils/services.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./src/checkout6-custom.js");
/******/ 	
/******/ })()
;